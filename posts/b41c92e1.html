<!DOCTYPE HTML><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1,minimum-scale=1"><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><meta http-equiv="Cache-Control" content="no-siteapp"><meta http-equiv="Cache-Control" content="no-transform"><meta name="renderer" content="webkit|ie-comp|ie-stand"><meta name="apple-mobile-web-app-capable" content="H多看源码多读书 - 勤于思考善领悟"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no,email=no,adress=no"><meta name="browsermode" content="application"><meta name="screen-orientation" content="portrait"><meta name="theme-version" content="1.3.0"><meta name="root" content="/"><link rel="dns-prefetch" href="http://example.com"><meta name="keywords" content="javascript,babel7,compiler"><meta name="description" content="🚀 彻底搞懂 Babel：从入门到进阶的全场景指南
📚 本指南旨在帮助开发者彻底掌握 Babel 7+ 的工作机制、配置技巧及核心插件系统的使用。


目录
Babel 简介
工作方式
快速..."><meta name="robots" content="all"><meta name="google" content="all"><meta name="googlebot" content="all"><meta name="verify" content="all"><title>Babel 7 从入门到进阶的全场景指南 | H多看源码多读书 - 勤于思考善领悟</title><link rel="alternate" href="/atom.xml" title="H多看源码多读书 - 勤于思考善领悟" type="application/atom+xml"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/bootstrap.min.css?rev=1d1bccdabbf21f3604f985399285f5cf"><link rel="stylesheet" href="/css/font-awesome.min.css?rev=17d35b1ddb5a58cc19379d19f22b9fdc"><link rel="stylesheet" href="/css/style.css?rev=1be479d06cbb29d0c56ae25586ad88bc"><div class="hide"><script type="text/javascript">!function(){var t="https:"===document.location.protocol?"https://":"http://",c=document.createElement("script");c.src="https://s95.cnzz.com/z_stat.php?web_id=1272564536",c.async=!0,document.body.appendChild(c);var e=document.createElement("script");e.src=t+"s19.cnzz.com/z_stat.php?id=1263868967&show=pic1",e.async=!0,document.body.appendChild(e)}()</script></div><meta name="generator" content="Hexo 7.3.0"></head><!--[if lte IE 8]><style>
    html{ font-size: 1em }
</style><![endif]--><!--[if lte IE 9]><div style="ie">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div><![endif]--><body><header class="main-header" style="background-image:url(https://picgo-2024.oss-cn-beijing.aliyuncs.com/img/banner.webp)"><div class="main-header-box"><a class="header-avatar" href="/" title="ZHB"><img src="/img/avatar.webp" alt="logo头像" class="img-responsive center-block"></a><div class="branding"><img src="/img/branding.png" alt="Snippet 博客主题" class="img-responsive center-block"></div></div></header><nav class="main-navigation"><div class="container"><div class="row"><div class="col-sm-12"><div class="navbar-header"><span class="nav-toggle-button collapsed pull-right" data-toggle="collapse" data-target="#main-menu" id="mnav"><span class="sr-only"></span><i class="fa fa-bars"></i></span> <a class="navbar-brand" href="http://example.com">H多看源码多读书 - 勤于思考善领悟</a></div><div class="collapse navbar-collapse" id="main-menu"><ul class="menu"><li role="presentation" class="text-center"><a href="/"><i class="fa"></i> 首页</a></li><li role="presentation" class="text-center"><a href="/categories/"><i class="fa"></i> 分类</a></li><li role="presentation" class="text-center"><a href="/tags/"><i class="fa"></i> 标签</a></li><li role="presentation" class="text-center"><a href="/archives/"><i class="fa"></i> 时间轴</a></li><li role="presentation" class="text-center"><a href="/about/"><i class="fa"></i> 关于</a></li></ul></div></div></div></div></nav><section class="content-wrap"><div class="container"><div class="row"><main class="col-md-9 main-content m-post"><p id="process"></p><article class="post"><div class="post-head"><h1 id="Babel 7 从入门到进阶的全场景指南">Babel 7 从入门到进阶的全场景指南</h1><div class="post-meta"><span class="categories-meta fa-wrap"><i class="fa fa-folder-open-o"></i> <a class="category-link" href="/categories/%E6%A1%86%E6%9E%B6%E4%B8%8E%E7%94%9F%E6%80%81/">框架与生态</a></span><span class="fa-wrap"><i class="fa fa-tags"></i> <span class="tags-meta"><a class="tag-none-link" href="/tags/babel7/" rel="tag">babel7</a> <a class="tag-none-link" href="/tags/compiler/" rel="tag">compiler</a> <a class="tag-none-link" href="/tags/javascript/" rel="tag">javascript</a></span></span><span class="fa-wrap"><i class="fa fa-clock-o"></i> <span class="date-meta">2026/02/27</span></span></div></div><div class="post-body post-content"><h1 id="🚀-彻底搞懂-Babel：从入门到进阶的全场景指南"><a href="#🚀-彻底搞懂-Babel：从入门到进阶的全场景指南" class="headerlink" title="🚀 彻底搞懂 Babel：从入门到进阶的全场景指南"></a>🚀 彻底搞懂 Babel：从入门到进阶的全场景指南</h1><blockquote><p>📚 本指南旨在帮助开发者彻底掌握 Babel 7+ 的工作机制、配置技巧及核心插件系统的使用。</p></blockquote><hr><h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><ol><li><a href="#%E4%B8%80-babel-%E7%AE%80%E4%BB%8B">Babel 简介</a></li><li><a href="#%E4%BA%8C-5-%E5%88%86%E9%92%9F%E6%90%9E%E6%87%82-babel-%E7%9A%84%E5%B7%A5%E4%BD%9C%E6%96%B9%E5%BC%8F">工作方式</a></li><li><a href="#%E4%B8%89-%E6%9C%80%E5%B0%8F%E5%8F%AF%E8%BF%90%E8%A1%8C%E7%A4%BA%E4%BE%8B">快速上手</a></li><li><a href="#%E5%9B%9B-%E5%BF%85%E9%A1%BB%E5%BC%84%E6%87%82%E7%9A%84-4-%E4%B8%AA%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5">核心概念</a></li><li><a href="#%E4%BA%94-preset-env--core-js">Polyfill 实战</a></li><li><a href="#%E5%85%AD-runtime-%E4%B8%8E-polyfill-%E7%9A%84%E5%8C%BA%E5%88%AB">Runtime 优化</a></li><li><a href="#%E4%B8%83-babel-%E4%B8%8E-ts--react-%E7%BB%93%E5%90%88">生态集成</a></li><li><a href="#%E5%85%AB-babel-%E5%9C%A8-webpack-%E5%92%8C-vite-%E4%B8%AD%E7%9A%84%E7%94%9F%E6%80%81%E5%AE%9A%E4%BD%8D">打包构建</a></li><li><a href="#%E4%B9%9D-ast%E9%81%8D%E5%8E%86%E4%B8%8E%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86%E9%80%9F%E9%80%9A">高级原理</a></li><li><a href="#%E5%8D%81-%E6%89%8B%E5%86%99%E4%B8%80%E4%B8%AA-babel-%E6%8F%92%E4%BB%B6">插件开发</a></li><li><a href="#%E5%8D%81%E4%B8%80-%E7%BB%88%E6%9E%81%E4%B8%80%E9%94%AE%E5%A4%8D%E5%88%B6%E9%85%8D%E7%BD%AE%E6%A8%A1%E6%9D%BF">配置模板</a></li></ol><br><h2 id="一、-Babel-简介"><a href="#一、-Babel-简介" class="headerlink" title="一、 Babel 简介"></a><strong>一、 Babel 简介</strong></h2><h3 id="1-1-Babel-是什么？解决什么问题？"><a href="#1-1-Babel-是什么？解决什么问题？" class="headerlink" title="1.1 Babel 是什么？解决什么问题？"></a><strong><font color="red">1.1 Babel 是什么？解决什么问题？</font></strong></h3><p><strong>一句话</strong>：Babel 是一个 <strong>JavaScript 编译器（Compiler &#x2F; Transpiler）</strong>，把“你写的现代 JS&#x2F;TS&#x2F;JSX”等代码，转换成“目标环境（老版浏览器&#x2F;Node）能平稳运行的代码”。</p><p>你会在这些场景用到 Babel：</p><ul><li><strong>降级新语法</strong>：把 ES202x 新语法转成旧语法（比如可选链 <code>?.</code>、空值合并 <code>??</code>、class 私有字段等）。</li><li><strong>编译 JSX</strong>：把 React 或 Vue 的 JSX 转成 <code>React.createElement</code> 或 <code>jsx-runtime</code> 的原生函数调用形式。</li><li><strong>擦除 TypeScript</strong>：把 TypeScript 里的类型声明直接去掉（<strong>注意：Babel 不做任何类型检查</strong>）。</li><li><strong>做代码定制化变换</strong>：比如自动注入日志、移除 <code>console.log</code>、按需引入组件库样式、甚至开发自己的宏（Macros），这些通常靠 Babel 插件完成。</li></ul><hr><br><h2 id="二、-5-分钟搞懂-Babel-的工作方式"><a href="#二、-5-分钟搞懂-Babel-的工作方式" class="headerlink" title="二、 5 分钟搞懂 Babel 的工作方式"></a><strong>二、 5 分钟搞懂 Babel 的工作方式</strong></h2><h3 id="2-1-编译流水线"><a href="#2-1-编译流水线" class="headerlink" title="2.1 编译流水线"></a><strong><font color="red">2.1 编译流水线</font></strong></h3><p>Babel 编译其实就是一条 3 步走的流水线：</p><ol><li><strong>Parse（解析）</strong>：源码字符串 → <strong>AST（抽象语法树）</strong></li><li><strong>Transform（转换）</strong>：对 AST 节点做各种增删改操作（<strong>Babel 插件全在这里工作</strong>）</li><li><strong>Generate（生成）</strong>：修改后的 AST → 新代码字符串（以及对应的 SourceMap）</li></ol><blockquote><p>💡 <strong>核心结论</strong>：</p><ul><li>Babel 自己的“本能”其实很弱，所有的实际能力都来自 <strong>插件（Plugins）</strong>。</li><li>但你不可能为了编译一个项目一个个去手写或安装几十个插件，所以官方提供了 <strong>预设（Presets）</strong>（即一组打包好的插件集合）。</li></ul></blockquote><hr><br><h2 id="三、-最小可运行示例"><a href="#三、-最小可运行示例" class="headerlink" title="三、 最小可运行示例"></a><strong>三、 最小可运行示例</strong></h2><blockquote><p>⚠️ <strong>避坑指南</strong>：Babel 7 开始，所有官方包都移入了 <code>@babel/</code> 作用域命名空间。如果你在网上查教程，看到 <code>babel-core</code>、<code>babel-preset-env</code>（没有 <code>@</code> 开头的），请直接关闭网页，那是老旧的 Babel 6 黑历史！</p></blockquote><h3 id="3-1-安装核心包"><a href="#3-1-安装核心包" class="headerlink" title="3.1 安装核心包"></a><strong><font color="red">3.1 安装核心包</font></strong></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -D @babel/core @babel/cli</span><br></pre></td></tr></table></figure><h3 id="3-2-写一个最简单的配置"><a href="#3-2-写一个最简单的配置" class="headerlink" title="3.2 写一个最简单的配置"></a><strong><font color="red">3.2 写一个最简单的配置</font></strong></h3><p>创建 <code>babel.config.json</code>（Babel 7 推荐，放置在项目根目录）：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;presets&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="3-3-尝试编译"><a href="#3-3-尝试编译" class="headerlink" title="3.3 尝试编译"></a><strong><font color="red">3.3 尝试编译</font></strong></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx babel src --out-dir dist</span><br></pre></td></tr></table></figure><p><em>你会发现：不加任何 preset 或 plugin 时，Babel 输出的代码和源码一模一样。因为它“没有被灌输任何变换规则”。</em></p><hr><br><h2 id="四、-必须弄懂的-4-个核心概念"><a href="#四、-必须弄懂的-4-个核心概念" class="headerlink" title="四、 必须弄懂的 4 个核心概念"></a><strong>四、 必须弄懂的 4 个核心概念</strong></h2><h3 id="4-1-babel-core-是什么？"><a href="#4-1-babel-core-是什么？" class="headerlink" title="4.1 @babel&#x2F;core 是什么？"></a><strong><font color="red">4.1 @babel&#x2F;core 是什么？</font></strong></h3><p>Babel 核心编译引擎，负责解析代码、调度执行配置好的插件、生成最终代码。但其实它自己什么语法都不会转。</p><h3 id="4-2-Plugin（插件）是什么？"><a href="#4-2-Plugin（插件）是什么？" class="headerlink" title="4.2 Plugin（插件）是什么？"></a><strong><font color="red">4.2 Plugin（插件）是什么？</font></strong></h3><p>插件就是一个 JS 模块，负责告诉 Babel：遇到某种特定的 AST 节点时，该怎么改。<br><em>例如：遇到“箭头函数”，就把它转成 <code>function () &#123;&#125;</code>；遇到 <code>?.</code>，就改成安全的兼容判断。</em></p><h3 id="4-3-Preset（预设）是什么？"><a href="#4-3-Preset（预设）是什么？" class="headerlink" title="4.3 Preset（预设）是什么？"></a><strong><font color="red">4.3 Preset（预设）是什么？</font></strong></h3><p>预设解决的是“懒人不用挑插件”的问题。现代项目最常用的老三样：</p><ul><li><strong><code>@babel/preset-env</code></strong>：智能预设，根据你配置的目标浏览器，自动决定需要转哪些 JS 语法。</li><li><strong><code>@babel/preset-react</code></strong>：专门用来编译 JSX。</li><li><strong><code>@babel/preset-typescript</code></strong>：负责把 TS 类型代码擦除成普通的 JS（不做类型检查）。</li></ul><h3 id="4-4-配置文件怎么选？"><a href="#4-4-配置文件怎么选？" class="headerlink" title="4.4 配置文件怎么选？"></a><strong><font color="red">4.4 配置文件怎么选？</font></strong></h3><ul><li><strong><code>babel.config.json</code>（Babel 7+ 强烈推荐）</strong>：作用于整个项目（甚至跨层级的 monorepo），一劳永逸。</li><li><strong><code>.babelrc</code> &#x2F; <code>.babelrc.json</code></strong>：只针对当前文件夹目录生效（局部配置），在复杂的 monorepo 工程中非常容易出现配置覆盖和失效的深坑。</li></ul><hr><br><h2 id="五、-babel-preset-env-core-js"><a href="#五、-babel-preset-env-core-js" class="headerlink" title="五、 @babel&#x2F;preset-env + core-js"></a><strong>五、 @babel&#x2F;preset-env + core-js</strong></h2><p>这一章是 Babel 学习的分水岭：大家经常把 <strong>语法转换</strong> 与 <strong>API 补齐（Polyfill）</strong> 混为一谈。</p><h3 id="5-1-语法转换-≠-API-补齐"><a href="#5-1-语法转换-≠-API-补齐" class="headerlink" title="5.1 语法转换 ≠ API 补齐"></a><strong><font color="red">5.1 语法转换 ≠ API 补齐</font></strong></h3><ul><li><strong>Babel（准确说是 preset-env 自身）主要负责语法</strong>：比如 <code>const</code> 改成 <code>var</code>、去掉箭头函数等。</li><li><strong>但是对于新的 API 或内置对象</strong>：比如 <code>Promise</code>、<code>Array.from</code>、<code>Object.assign</code>、<code>[].includes</code>，老浏览器里根本没有这些全局对象和原型方法。Babel 转换后还是 <code>Promise</code> 字母，必定在旧浏览器报错。我们需要 <strong>Polyfill</strong> 给环境打补丁。</li></ul><blockquote><p>⚠️ <strong>废弃提醒</strong>：以前大家常装一个万金油包叫 <code>@babel/polyfill</code>。<strong>从 Babel 7.4 起这个包已被废弃！</strong> 现在的标准做法是直接使用 <code>core-js</code>，靠 <code>preset-env</code> 去自动引入。</p></blockquote><h3 id="5-2-正确的配置姿势（按需注入-Polyfill）"><a href="#5-2-正确的配置姿势（按需注入-Polyfill）" class="headerlink" title="5.2 正确的配置姿势（按需注入 Polyfill）"></a><strong><font color="red">5.2 正确的配置姿势（按需注入 Polyfill）</font></strong></h3><p>首先安装 <code>core-js</code>（生产依赖）：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm i core-js</span><br><span class="line"><span class="comment"># 注意，preset 仍然放开发依赖</span></span><br><span class="line">npm i -D @babel/preset-env</span><br></pre></td></tr></table></figure><p>配置 <code>babel.config.json</code>：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;presets&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;@babel/preset-env&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;targets&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&gt; 0.2%, not dead&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;useBuiltIns&quot;</span><span class="punctuation">:</span> <span class="string">&quot;usage&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;corejs&quot;</span><span class="punctuation">:</span> <span class="string">&quot;3.38&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;modules&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h4 id="1）必懂参数解析"><a href="#1）必懂参数解析" class="headerlink" title="1）必懂参数解析"></a><strong><font color="#10c300">1）必懂参数解析</font></strong></h4><ul><li><code>targets</code>：你的目标环境。建议将其放到 <code>package.json</code> 的 <code>browserslist</code> 字段中统一定义，这里可以直接不写。</li><li><code>useBuiltIns: &quot;usage&quot;</code>：<strong>真正的神级配置，重点注意！</strong> 这是按需加载模式。这意味着在你项目的<strong>源码文件中，绝对不需要手动写 <code>import &#39;core-js&#39;</code></strong>。Babel 会静态分析你的代码，比如你用到了 <code>Promise</code>，它就在编译后的该文件顶部，自动帮你默默塞入一句 <code>import &quot;core-js/modules/es.promise.js&quot;</code>。这就叫按需补齐，体积最小！<ul><li><em>（补充：如果这里配置成 <code>&quot;entry&quot;</code>，那你才需要在项目入口文件如 <code>main.js</code> 的第一行手动写上一句 <code>import &quot;core-js&quot;</code>，此模式会把浏览器缺失的 API 全量打进来，容易导致包体积过大，不推荐。）</em></li></ul></li><li><code>corejs</code>：指定 core-js 的主版本号（目前标配使用的是 3.x ）。</li><li><code>modules: false</code>：让 Babel 别管 ES6 Module 的 <code>import/export</code>，把模块化的保留权交给 Webpack&#x2F;Vite 这种打包工具，以便它们做无用代码修剪（Tree-shaking）。</li></ul><hr><br><h2 id="六、-Runtime-与-Polyfill-的区别"><a href="#六、-Runtime-与-Polyfill-的区别" class="headerlink" title="六、 Runtime 与 Polyfill 的区别"></a><strong>六、 Runtime 与 Polyfill 的区别</strong></h2><p>很多人到死都没搞清楚 <code>core-js</code> 和 <code>@babel/runtime</code> 为什么同时出现。</p><h3 id="6-1-为什么需要-runtime-插件？"><a href="#6-1-为什么需要-runtime-插件？" class="headerlink" title="6.1 为什么需要 runtime 插件？"></a><strong><font color="red">6.1 为什么需要 runtime 插件？</font></strong></h3><p>Babel 在转译像 <code>class</code>、<code>async/await</code> 这种复杂新特性时，会在文件里注入一些辅助函数（Helpers）。比如：<code>_classCallCheck</code>。<br>如果项目里有 100 个文件用了 <code>class</code>，这段冗长的 helper 函数就会被内联 100 次，包体积会变得极速膨胀。</p><h3 id="6-2-transform-runtime-的作用"><a href="#6-2-transform-runtime-的作用" class="headerlink" title="6.2 transform-runtime 的作用"></a><strong><font color="red">6.2 transform-runtime 的作用</font></strong></h3><p>安装配套：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm i -D @babel/plugin-transform-runtime</span><br><span class="line">npm i @babel/runtime</span><br></pre></td></tr></table></figure><p>配置（<strong>这通常写在你的 <code>babel.config.json</code> 或对应 Babel 配置文件中</strong>）：</p><blockquote><p>💡 <strong>极其容易困惑的基础知识</strong>：<br>在 Babel 配置文件中，<code>presets</code>（预设数组） 和 <code>plugins</code>（插件数组） 是<strong>完全同级并列</strong>的。</p></blockquote><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;presets&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="comment">// 这里放 Babel 的环境预设、React 预设等</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;plugins&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;@babel/plugin-transform-runtime&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="comment">// 核心参数：告诉 Babel 帮我把内联的辅助函数（Helpers）替换为以 module 形式引入 @babel/runtime 相关方法</span></span><br><span class="line">        <span class="attr">&quot;helpers&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="comment">// 是否开启 generator 相关的 polyfill 抽离，避免全局污染全局变量</span></span><br><span class="line">        <span class="attr">&quot;regenerator&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">        <span class="comment">// (可选) 如果你是开发 npm 包库，不想全局引入 Promise 等 API</span></span><br><span class="line">        <span class="comment">// 你可以把这里的 corejs 设为 3，让 Babel 从 runtime 帮你进行局部的安全 polyfill 加载</span></span><br><span class="line">        <span class="comment">// &quot;corejs&quot;: 3</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h4 id="1）核心结论"><a href="#1）核心结论" class="headerlink" title="1）核心结论"></a><strong><font color="#10c300">1）核心结论</font></strong></h4><p><code>transform-runtime</code> 被召唤出来就是为了 <strong>避免每个文件重复声明 Babel Helper</strong>。它会把那些注入的辅助函数，统统变成 <code>require(&quot;@babel/runtime/helpers/xxx&quot;)</code> 这个包里的引用。包体积瞬间被拯救。</p><blockquote><p>💡 <strong>项目选择建议</strong>：</p><ul><li><strong>做业务项目（Web App）</strong>：用 <code>@babel/preset-env</code> 配上 <code>core-js</code> (useBuiltIns) 做全局 Polyfill。</li><li><strong>开发基础组件库&#x2F;NPM 包</strong>：尽量不要用 <code>useBuiltIns</code> 去污染全局原型，而是完全依赖 <code>@babel/plugin-transform-runtime</code> 做局部沙盒版的 api 隔离降级（配置它的 <code>corejs</code> 选项）。</li></ul></blockquote><hr><br><h2 id="七、-Babel-与-TS-React-结合"><a href="#七、-Babel-与-TS-React-结合" class="headerlink" title="七、 Babel 与 TS &#x2F; React 结合"></a><strong>七、 Babel 与 TS &#x2F; React 结合</strong></h2><h3 id="7-1-React：自动引入-JSX-运行时"><a href="#7-1-React：自动引入-JSX-运行时" class="headerlink" title="7.1 React：自动引入 JSX 运行时"></a><strong><font color="red">7.1 React：自动引入 JSX 运行时</font></strong></h3><p>配置：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;presets&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">[</span><span class="string">&quot;@babel/preset-react&quot;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span> <span class="attr">&quot;runtime&quot;</span><span class="punctuation">:</span> <span class="string">&quot;automatic&quot;</span> <span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><em><code>runtime: &quot;automatic&quot;</code>（React 17+ 特性）意味着你再也不用在组件第一行手动写 <code>import React from &quot;react&quot;</code> 了。</em></p><h3 id="7-2-TypeScript：编译-TS-这点坑"><a href="#7-2-TypeScript：编译-TS-这点坑" class="headerlink" title="7.2 TypeScript：编译 TS 这点坑"></a><strong><font color="red">7.2 TypeScript：编译 TS 这点坑</font></strong></h3><p>配置：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;presets&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;@babel/preset-typescript&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h4 id="1）关键注意事项"><a href="#1）关键注意事项" class="headerlink" title="1）关键注意事项"></a><strong><font color="#10c300">1）关键注意事项</font></strong></h4><ol><li>Babel 剥离 TS 极快，但<strong>不负责类型检查</strong>。想要类型检查报错，得加上 <code>tsc --noEmit</code> 命令配合。<ul><li><strong>具体操作</strong>：你应该在根目录下生成一个 <code>tsconfig.json</code> 文件。然后在项目的 <code>package.json</code> 的 <code>scripts</code> 中添加一条脚本，例如 <code>&quot;type-check&quot;: &quot;tsc --noEmit&quot;</code>。在每次打包（如 <code>npm run build</code>）或者提交代码（配合 husky + lint-staged）之前，先运行这条命令，以便把任何类型错误扼杀在摇篮里。这里 <code>--noEmit</code> 的意思是：tsc 编译器只负责报错，坚决不输出任何编译后的 js 文件（因为输出打包的工作已经全权交给 Babel &#x2F; Webpack &#x2F; Vite 了）。</li></ul></li><li><strong>踩坑预警</strong>：如果你直接用 <code>@babel/cli</code> 去编译一个带有 TS 文件的项目，它默认是会忽略 <code>.ts</code> 扩展名的！必须通过 CLI 指定扩展名才能生效：<br><code>npx babel src --out-dir dist --extensions &quot;.ts,.tsx&quot;</code></li></ol><hr><br><h2 id="八、-Babel-在-Webpack-和-Vite-中的生态定位"><a href="#八、-Babel-在-Webpack-和-Vite-中的生态定位" class="headerlink" title="八、 Babel 在 Webpack 和 Vite 中的生态定位"></a><strong>八、 Babel 在 Webpack 和 Vite 中的生态定位</strong></h2><ul><li><strong>Webpack（搭配 <code>babel-loader</code>）</strong>：<br>在 Webpack 中，一切都靠 loader 接入。当 Webpack 遇到 <code>.js/.ts/.jsx</code> 时，会交给 <code>babel-loader</code> 唤醒 Babel 编译，编译后的字符串再吐回给 Webpack 打包。</li><li><strong>Vite（基于 ESBuild）</strong>：<br>Vite 在开发环境下主要使用 go 语言写的 ESBuild 极速转译代码，默认不启用 Babel。但在一些依赖 Babel 生态的场景下（例如 React 的 Fast Refresh 热更新、CSS in JS 宏、旧版本浏览器兼容、按需组件导入等），Vite 依然会借助自身的插件底层调用 Babel 辅助构建。</li></ul><hr><br><h2 id="九、-AST、遍历与编译原理速通"><a href="#九、-AST、遍历与编译原理速通" class="headerlink" title="九、 AST、遍历与编译原理速通"></a><strong>九、 AST、遍历与编译原理速通</strong></h2><p>你不需要成为编译原理专家，但要记住这 3 个词：</p><h3 id="9-1-AST（Abstract-Syntax-Tree，抽象语法树）"><a href="#9-1-AST（Abstract-Syntax-Tree，抽象语法树）" class="headerlink" title="9.1 AST（Abstract Syntax Tree，抽象语法树）"></a><strong><font color="red">9.1 AST（Abstract Syntax Tree，抽象语法树）</font></strong></h3><p>简单来说：<strong>AST 就是把你写的“源代码字符串”，转换成了计算机（编译器）更容易理解和操作的“树状数据结构”。</strong></p><ul><li><strong>为什么需要 AST？</strong><br>对于计算机来说，代码只是一串字符序列，想要修改、翻译或者检查代码（比如处理复杂的嵌套和作用域），直接操作字符串极其困难。所以需要把一维字符串解析成结构化的树状数据（通常是 JSON 格式）。</li><li><strong>代码是怎么变成 AST 的？</strong><br>这个过程叫做<strong>解析（Parsing）</strong>，通常分为两步：<ul><li><strong>词法分析（Tokenization）</strong>：把代码切成一个个具备独立意义的“词法单元”（Tokens）。例如 <code>let a = 1;</code> 会被切成：<code>let</code>, <code>a</code>, <code>=</code>, <code>1</code>, <code>;</code>。</li><li><strong>语法分析（Syntax Analysis）</strong>：把切出来的 Tokens 数组，根据 JS 语法规则组合拼装成树状结构（AST）。比如 <code>let a = 1;</code> 会被解析成包含 <code>VariableDeclaration</code>、<code>Identifier</code>、<code>NumericLiteral</code> 等节点的树。</li></ul></li><li><strong>AST 的用处：</strong><br>前端工程化里 90% 的“魔法”（比如 Babel 转译、ESLint 检查、Webpack 构建依赖图谱、Vue&#x2F;React 模板编译）的核心流程都是：<strong>源码 → AST → 操作（修改&#x2F;分析）AST → 重新生成代码</strong>。</li></ul><h3 id="9-2-Visitor（访问者模式）"><a href="#9-2-Visitor（访问者模式）" class="headerlink" title="9.2 Visitor（访问者模式）"></a><strong><font color="red">9.2 Visitor（访问者模式）</font></strong></h3><p>你可以把这个想成一个事件监听器，设定“当我遍历 AST 遇到特定的节点（比如遇到 <code>BinaryExpression</code> 节点）时，触发我的回调函数”。</p><h3 id="9-3-Path（路径对象）"><a href="#9-3-Path（路径对象）" class="headerlink" title="9.3 Path（路径对象）"></a><strong><font color="red">9.3 Path（路径对象）</font></strong></h3><p>插件拿到节点不仅仅是拿到节点本身的数据，而是拿到一个 Path 包装对象。它不仅包含了当前节点的信息，还包含了节点之间的父子上下文关联，并通过调用 <code>path.replaceWith()</code>、<code>path.remove()</code> 等提供的一整套 API 让你去安全地修改和操作 these 节点。</p><hr><br><h2 id="十、-手写一个-Babel-插件"><a href="#十、-手写一个-Babel-插件" class="headerlink" title="十、 手写一个 Babel 插件"></a><strong>十、 手写一个 Babel 插件</strong></h2><p><strong>需求</strong>：把代码中的 <code>__DEV__</code> 替换为 <code>process.env.NODE_ENV !== &quot;production&quot;</code>，方便做开发环境包裹。</p><h3 id="10-1-插件代码（replace-dev-flag-js）"><a href="#10-1-插件代码（replace-dev-flag-js）" class="headerlink" title="10.1 插件代码（replace-dev-flag.js）"></a><strong><font color="red">10.1 插件代码（<code>replace-dev-flag.js</code>）</font></strong></h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">function</span> <span class="title function_">myPlugin</span>(<span class="params">&#123; types: t &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;replace-dev-flag&quot;</span>,</span><br><span class="line">    <span class="attr">visitor</span>: &#123;</span><br><span class="line">      <span class="title class_">Identifier</span>(path) &#123;</span><br><span class="line">        <span class="comment">// 发现不是目标变量，直接放行</span></span><br><span class="line">        <span class="keyword">if</span> (path.<span class="property">node</span>.<span class="property">name</span> !== <span class="string">&quot;__DEV__&quot;</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 生成目标表达式</span></span><br><span class="line">        path.<span class="title function_">replaceWith</span>(</span><br><span class="line">          t.<span class="title function_">binaryExpression</span>(</span><br><span class="line">            <span class="string">&quot;!==&quot;</span>,</span><br><span class="line">            t.<span class="title function_">memberExpression</span>(</span><br><span class="line">              t.<span class="title function_">memberExpression</span>(t.<span class="title function_">identifier</span>(<span class="string">&quot;process&quot;</span>), t.<span class="title function_">identifier</span>(<span class="string">&quot;env&quot;</span>)),</span><br><span class="line">              t.<span class="title function_">identifier</span>(<span class="string">&quot;NODE_ENV&quot;</span>),</span><br><span class="line">            ),</span><br><span class="line">            t.<span class="title function_">stringLiteral</span>(<span class="string">&quot;production&quot;</span>),</span><br><span class="line">          ),</span><br><span class="line">        );</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="10-2-在配置中使用它"><a href="#10-2-在配置中使用它" class="headerlink" title="10.2 在配置中使用它"></a><strong><font color="red">10.2 在配置中使用它</font></strong></h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;plugins&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;./babel-plugins/replace-dev-flag.js&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><hr><br><h2 id="十一、-终极一键复制配置模板"><a href="#十一、-终极一键复制配置模板" class="headerlink" title="十一、 终极一键复制配置模板"></a><strong>十一、 终极一键复制配置模板</strong></h2><h3 id="11-1-绝大多数现代工程（Vue-普通-JS-项目，使用打包工具）"><a href="#11-1-绝大多数现代工程（Vue-普通-JS-项目，使用打包工具）" class="headerlink" title="11.1 绝大多数现代工程（Vue&#x2F;普通 JS 项目，使用打包工具）"></a><strong><font color="red">11.1 绝大多数现代工程（Vue&#x2F;普通 JS 项目，使用打包工具）</font></strong></h3><p><strong><code>babel.config.json</code></strong>：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;presets&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;@babel/preset-env&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;modules&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;useBuiltIns&quot;</span><span class="punctuation">:</span> <span class="string">&quot;usage&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;corejs&quot;</span><span class="punctuation">:</span> <span class="string">&quot;3.38&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;plugins&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;@babel/plugin-transform-runtime&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;helpers&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;regenerator&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><strong>依赖清单</strong>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm i -D @babel/core @babel/preset-env @babel/plugin-transform-runtime</span><br><span class="line">npm i core-js @babel/runtime</span><br></pre></td></tr></table></figure><h3 id="11-2-React-TS-前端主应用项目"><a href="#11-2-React-TS-前端主应用项目" class="headerlink" title="11.2 React + TS 前端主应用项目"></a><strong><font color="red">11.2 React + TS 前端主应用项目</font></strong></h3><p><strong><code>babel.config.json</code></strong>：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;presets&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;@babel/preset-env&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;modules&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;useBuiltIns&quot;</span><span class="punctuation">:</span> <span class="string">&quot;usage&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;corejs&quot;</span><span class="punctuation">:</span> <span class="string">&quot;3.38&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">[</span><span class="string">&quot;@babel/preset-react&quot;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span> <span class="attr">&quot;runtime&quot;</span><span class="punctuation">:</span> <span class="string">&quot;automatic&quot;</span> <span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;@babel/preset-typescript&quot;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;plugins&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;@babel/plugin-transform-runtime&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span> <span class="attr">&quot;helpers&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span> <span class="attr">&quot;regenerator&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span> <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div><div class="post-footer"><div>转载声明： 商业转载请联系作者获得授权,非商业转载请注明出处 © <a href="" target="_blank">ZHB</a></div><div></div></div></article><div class="article-nav prev-next-wrap clearfix"><a href="/posts/f8a2c3d9xr.html" class="pre-post btn btn-default" title="Sentry集成与hidden-source-map源码溯源指南"><i class="fa fa-angle-left fa-fw"></i> <span class="hidden-lg">上一篇</span> <span class="hidden-xs">Sentry集成与hidden-source-map源码溯源指南</span></a> <a href="/posts/w41d92f5.html" class="next-post btn btn-default" title="JavaScript 模块化与 Webpack 5：从原理剖析到工程化实战"><span class="hidden-lg">下一篇</span> <span class="hidden-xs">JavaScript 模块化与 Webpack 5：从原理剖析到工程化实战</span><i class="fa fa-angle-right fa-fw"></i></a></div><div id="comments"><div class="utteranc"><script src="https://utteranc.es/client.js" repo="shenliyang/snippet-comment" issue-term="pathname" issue-number="" theme="github-light" label="" crossorigin="anonymous" async></script></div></div></main><aside id="article-toc" role="navigation" class="col-md-3"><div class="widget"><h3 class="title">文章目录</h3><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%F0%9F%9A%80-%E5%BD%BB%E5%BA%95%E6%90%9E%E6%87%82-Babel%EF%BC%9A%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E8%BF%9B%E9%98%B6%E7%9A%84%E5%85%A8%E5%9C%BA%E6%99%AF%E6%8C%87%E5%8D%97"><span class="toc-text">🚀 彻底搞懂 Babel：从入门到进阶的全场景指南</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95"><span class="toc-text">目录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81-Babel-%E7%AE%80%E4%BB%8B"><span class="toc-text">一、 Babel 简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-Babel-%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F%E8%A7%A3%E5%86%B3%E4%BB%80%E4%B9%88%E9%97%AE%E9%A2%98%EF%BC%9F"><span class="toc-text">1.1 Babel 是什么？解决什么问题？</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81-5-%E5%88%86%E9%92%9F%E6%90%9E%E6%87%82-Babel-%E7%9A%84%E5%B7%A5%E4%BD%9C%E6%96%B9%E5%BC%8F"><span class="toc-text">二、 5 分钟搞懂 Babel 的工作方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E7%BC%96%E8%AF%91%E6%B5%81%E6%B0%B4%E7%BA%BF"><span class="toc-text">2.1 编译流水线</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81-%E6%9C%80%E5%B0%8F%E5%8F%AF%E8%BF%90%E8%A1%8C%E7%A4%BA%E4%BE%8B"><span class="toc-text">三、 最小可运行示例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E5%AE%89%E8%A3%85%E6%A0%B8%E5%BF%83%E5%8C%85"><span class="toc-text">3.1 安装核心包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E5%86%99%E4%B8%80%E4%B8%AA%E6%9C%80%E7%AE%80%E5%8D%95%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="toc-text">3.2 写一个最简单的配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E5%B0%9D%E8%AF%95%E7%BC%96%E8%AF%91"><span class="toc-text">3.3 尝试编译</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81-%E5%BF%85%E9%A1%BB%E5%BC%84%E6%87%82%E7%9A%84-4-%E4%B8%AA%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5"><span class="toc-text">四、 必须弄懂的 4 个核心概念</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-babel-core-%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-text">4.1 @babel&#x2F;core 是什么？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-Plugin%EF%BC%88%E6%8F%92%E4%BB%B6%EF%BC%89%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-text">4.2 Plugin（插件）是什么？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-Preset%EF%BC%88%E9%A2%84%E8%AE%BE%EF%BC%89%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-text">4.3 Preset（预设）是什么？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%80%8E%E4%B9%88%E9%80%89%EF%BC%9F"><span class="toc-text">4.4 配置文件怎么选？</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81-babel-preset-env-core-js"><span class="toc-text">五、 @babel&#x2F;preset-env + core-js</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E8%AF%AD%E6%B3%95%E8%BD%AC%E6%8D%A2-%E2%89%A0-API-%E8%A1%A5%E9%BD%90"><span class="toc-text">5.1 语法转换 ≠ API 补齐</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E6%AD%A3%E7%A1%AE%E7%9A%84%E9%85%8D%E7%BD%AE%E5%A7%BF%E5%8A%BF%EF%BC%88%E6%8C%89%E9%9C%80%E6%B3%A8%E5%85%A5-Polyfill%EF%BC%89"><span class="toc-text">5.2 正确的配置姿势（按需注入 Polyfill）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%EF%BC%89%E5%BF%85%E6%87%82%E5%8F%82%E6%95%B0%E8%A7%A3%E6%9E%90"><span class="toc-text">1）必懂参数解析</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81-Runtime-%E4%B8%8E-Polyfill-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-text">六、 Runtime 与 Polyfill 的区别</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81-runtime-%E6%8F%92%E4%BB%B6%EF%BC%9F"><span class="toc-text">6.1 为什么需要 runtime 插件？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-transform-runtime-%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-text">6.2 transform-runtime 的作用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%EF%BC%89%E6%A0%B8%E5%BF%83%E7%BB%93%E8%AE%BA"><span class="toc-text">1）核心结论</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81-Babel-%E4%B8%8E-TS-React-%E7%BB%93%E5%90%88"><span class="toc-text">七、 Babel 与 TS &#x2F; React 结合</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-React%EF%BC%9A%E8%87%AA%E5%8A%A8%E5%BC%95%E5%85%A5-JSX-%E8%BF%90%E8%A1%8C%E6%97%B6"><span class="toc-text">7.1 React：自动引入 JSX 运行时</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-TypeScript%EF%BC%9A%E7%BC%96%E8%AF%91-TS-%E8%BF%99%E7%82%B9%E5%9D%91"><span class="toc-text">7.2 TypeScript：编译 TS 这点坑</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%EF%BC%89%E5%85%B3%E9%94%AE%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-text">1）关键注意事项</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB%E3%80%81-Babel-%E5%9C%A8-Webpack-%E5%92%8C-Vite-%E4%B8%AD%E7%9A%84%E7%94%9F%E6%80%81%E5%AE%9A%E4%BD%8D"><span class="toc-text">八、 Babel 在 Webpack 和 Vite 中的生态定位</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B9%9D%E3%80%81-AST%E3%80%81%E9%81%8D%E5%8E%86%E4%B8%8E%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86%E9%80%9F%E9%80%9A"><span class="toc-text">九、 AST、遍历与编译原理速通</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-1-AST%EF%BC%88Abstract-Syntax-Tree%EF%BC%8C%E6%8A%BD%E8%B1%A1%E8%AF%AD%E6%B3%95%E6%A0%91%EF%BC%89"><span class="toc-text">9.1 AST（Abstract Syntax Tree，抽象语法树）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-2-Visitor%EF%BC%88%E8%AE%BF%E9%97%AE%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%89"><span class="toc-text">9.2 Visitor（访问者模式）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-3-Path%EF%BC%88%E8%B7%AF%E5%BE%84%E5%AF%B9%E8%B1%A1%EF%BC%89"><span class="toc-text">9.3 Path（路径对象）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E3%80%81-%E6%89%8B%E5%86%99%E4%B8%80%E4%B8%AA-Babel-%E6%8F%92%E4%BB%B6"><span class="toc-text">十、 手写一个 Babel 插件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-%E6%8F%92%E4%BB%B6%E4%BB%A3%E7%A0%81%EF%BC%88replace-dev-flag-js%EF%BC%89"><span class="toc-text">10.1 插件代码（replace-dev-flag.js）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-2-%E5%9C%A8%E9%85%8D%E7%BD%AE%E4%B8%AD%E4%BD%BF%E7%94%A8%E5%AE%83"><span class="toc-text">10.2 在配置中使用它</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%B8%80%E3%80%81-%E7%BB%88%E6%9E%81%E4%B8%80%E9%94%AE%E5%A4%8D%E5%88%B6%E9%85%8D%E7%BD%AE%E6%A8%A1%E6%9D%BF"><span class="toc-text">十一、 终极一键复制配置模板</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#11-1-%E7%BB%9D%E5%A4%A7%E5%A4%9A%E6%95%B0%E7%8E%B0%E4%BB%A3%E5%B7%A5%E7%A8%8B%EF%BC%88Vue-%E6%99%AE%E9%80%9A-JS-%E9%A1%B9%E7%9B%AE%EF%BC%8C%E4%BD%BF%E7%94%A8%E6%89%93%E5%8C%85%E5%B7%A5%E5%85%B7%EF%BC%89"><span class="toc-text">11.1 绝大多数现代工程（Vue&#x2F;普通 JS 项目，使用打包工具）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-2-React-TS-%E5%89%8D%E7%AB%AF%E4%B8%BB%E5%BA%94%E7%94%A8%E9%A1%B9%E7%9B%AE"><span class="toc-text">11.2 React + TS 前端主应用项目</span></a></li></ol></li></ol></li></ol></div></aside></div></div></section><footer class="main-footer"><div class="container"><div class="row"></div></div></footer><a id="back-to-top" class="icon-btn hide"><i class="fa fa-chevron-up"></i></a><div class="copyright"><div class="container"><div class="row"><div class="col-sm-12"><div class="busuanzi"></div></div><div class="col-sm-12"><span>Copyright &copy; 2017</span> | <span>Powered by <a href="//hexo.io" class="copyright-links" target="_blank" rel="nofollow">Hexo</a></span> | <span>Theme by <a href="//github.com/shenliyang/hexo-theme-snippet.git" class="copyright-links" target="_blank" rel="nofollow">Snippet</a></span></div></div></div></div><script src="/js/app.js?rev=2f9097f8c1d5adfecd923b78b47be31b"></script></body></html>