<!DOCTYPE HTML><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1,minimum-scale=1"><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><meta http-equiv="Cache-Control" content="no-siteapp"><meta http-equiv="Cache-Control" content="no-transform"><meta name="renderer" content="webkit|ie-comp|ie-stand"><meta name="apple-mobile-web-app-capable" content="Hå¤šçœ‹æºç å¤šè¯»ä¹¦ - å‹¤äºæ€è€ƒå–„é¢†æ‚Ÿ"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no,email=no,adress=no"><meta name="browsermode" content="application"><meta name="screen-orientation" content="portrait"><meta name="theme-version" content="1.3.0"><meta name="root" content="/"><link rel="dns-prefetch" href="http://example.com"><meta name="keywords" content="React,React Router"><meta name="description" content="React Router å…¨é¢æŒ‡å— (v6.4+ &amp; v7)
ğŸ“š æœ¬æŒ‡å—æ—¨åœ¨å¸®åŠ©å¼€å‘è€…æŒæ¡ React Router çš„æœ€æ–°ç‰¹æ€§ (v6.4+ Data APIs) åŠä¼ä¸šçº§å°è£…å†™æ³•ã€‚..."><meta name="robots" content="all"><meta name="google" content="all"><meta name="googlebot" content="all"><meta name="verify" content="all"><title>React Router å…¨é¢æŒ‡å— (v6.4+ &amp; v7) | Hå¤šçœ‹æºç å¤šè¯»ä¹¦ - å‹¤äºæ€è€ƒå–„é¢†æ‚Ÿ</title><link rel="alternate" href="/atom.xml" title="Hå¤šçœ‹æºç å¤šè¯»ä¹¦ - å‹¤äºæ€è€ƒå–„é¢†æ‚Ÿ" type="application/atom+xml"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/bootstrap.min.css?rev=1d1bccdabbf21f3604f985399285f5cf"><link rel="stylesheet" href="/css/font-awesome.min.css?rev=17d35b1ddb5a58cc19379d19f22b9fdc"><link rel="stylesheet" href="/css/style.css?rev=1be479d06cbb29d0c56ae25586ad88bc"><div class="hide"><script type="text/javascript">!function(){var t="https:"===document.location.protocol?"https://":"http://",c=document.createElement("script");c.src="https://s95.cnzz.com/z_stat.php?web_id=1272564536",c.async=!0,document.body.appendChild(c);var e=document.createElement("script");e.src=t+"s19.cnzz.com/z_stat.php?id=1263868967&show=pic1",e.async=!0,document.body.appendChild(e)}()</script></div><meta name="generator" content="Hexo 7.3.0"></head><!--[if lte IE 8]><style>
    html{ font-size: 1em }
</style><![endif]--><!--[if lte IE 9]><div style="ie">ä½ ä½¿ç”¨çš„æµè§ˆå™¨ç‰ˆæœ¬è¿‡ä½ï¼Œä¸ºäº†ä½ æ›´å¥½çš„é˜…è¯»ä½“éªŒï¼Œè¯·æ›´æ–°æµè§ˆå™¨çš„ç‰ˆæœ¬æˆ–è€…ä½¿ç”¨å…¶ä»–ç°ä»£æµè§ˆå™¨ï¼Œæ¯”å¦‚Chromeã€Firefoxã€Safariç­‰ã€‚</div><![endif]--><body><header class="main-header" style="background-image:url(https://picgo-2024.oss-cn-beijing.aliyuncs.com/img/banner.webp)"><div class="main-header-box"><a class="header-avatar" href="/" title="ZHB"><img src="/img/avatar.webp" alt="logoå¤´åƒ" class="img-responsive center-block"></a><div class="branding"><img src="/img/branding.png" alt="Snippet åšå®¢ä¸»é¢˜" class="img-responsive center-block"></div></div></header><nav class="main-navigation"><div class="container"><div class="row"><div class="col-sm-12"><div class="navbar-header"><span class="nav-toggle-button collapsed pull-right" data-toggle="collapse" data-target="#main-menu" id="mnav"><span class="sr-only"></span><i class="fa fa-bars"></i></span> <a class="navbar-brand" href="http://example.com">Hå¤šçœ‹æºç å¤šè¯»ä¹¦ - å‹¤äºæ€è€ƒå–„é¢†æ‚Ÿ</a></div><div class="collapse navbar-collapse" id="main-menu"><ul class="menu"><li role="presentation" class="text-center"><a href="/"><i class="fa"></i> é¦–é¡µ</a></li><li role="presentation" class="text-center"><a href="/categories/"><i class="fa"></i> åˆ†ç±»</a></li><li role="presentation" class="text-center"><a href="/tags/"><i class="fa"></i> æ ‡ç­¾</a></li><li role="presentation" class="text-center"><a href="/archives/"><i class="fa"></i> æ—¶é—´è½´</a></li><li role="presentation" class="text-center"><a href="/about/"><i class="fa"></i> å…³äº</a></li></ul></div></div></div></div></nav><section class="content-wrap"><div class="container"><div class="row"><main class="col-md-9 main-content m-post"><p id="process"></p><article class="post"><div class="post-head"><h1 id="React Router å…¨é¢æŒ‡å— (v6.4+ &amp; v7)">React Router å…¨é¢æŒ‡å— (v6.4+ &amp; v7)</h1><div class="post-meta"><span class="categories-meta fa-wrap"><i class="fa fa-folder-open-o"></i> <a class="category-link" href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/">å‰ç«¯å¼€å‘</a></span><span class="fa-wrap"><i class="fa fa-tags"></i> <span class="tags-meta"><a class="tag-none-link" href="/tags/React/" rel="tag">React</a> <a class="tag-none-link" href="/tags/React-Router/" rel="tag">React Router</a></span></span><span class="fa-wrap"><i class="fa fa-clock-o"></i> <span class="date-meta">2026/02/11</span></span></div></div><div class="post-body post-content"><h1 id="React-Router-å…¨é¢æŒ‡å—-v6-4-v7"><a href="#React-Router-å…¨é¢æŒ‡å—-v6-4-v7" class="headerlink" title="React Router å…¨é¢æŒ‡å— (v6.4+ &amp; v7)"></a>React Router å…¨é¢æŒ‡å— (v6.4+ &amp; v7)</h1><blockquote><p>ğŸ“š æœ¬æŒ‡å—æ—¨åœ¨å¸®åŠ©å¼€å‘è€…æŒæ¡ React Router çš„æœ€æ–°ç‰¹æ€§ (v6.4+ Data APIs) åŠä¼ä¸šçº§å°è£…å†™æ³•ã€‚</p></blockquote><hr><h2 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h2><ol><li><a href="#%E4%B8%80%E5%BC%95%E8%A8%80">å¼•è¨€</a></li><li><a href="#%E4%BA%8C%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B-data-router">å¿«é€Ÿä¸Šæ‰‹ (Data Router)</a></li><li><a href="#%E4%B8%89%E8%B7%AF%E7%94%B1%E6%A0%B8%E5%BF%83%E5%9F%BA%E7%A1%80-routing">è·¯ç”±æ ¸å¿ƒåŸºç¡€ (Routing)</a></li><li><a href="#%E5%9B%9Bdata-api-%E8%BF%9B%E9%98%B6">Data API (è¿›é˜¶)</a></li><li><a href="#%E4%BA%94%E5%B0%81%E8%A3%85%E5%BC%8F%E8%B7%AF%E7%94%B1%E9%85%8D%E7%BD%AE-best-practice">å°è£…å¼è·¯ç”±é…ç½®</a></li><li><a href="#%E5%85%AD%E8%BF%9B%E9%98%B6%E4%B8%8E%E4%BC%98%E5%8C%96">è¿›é˜¶ä¸ä¼˜åŒ–</a></li><li><a href="#%E4%B8%83%E5%B8%B8%E8%A7%81%E8%AF%AF%E5%8C%BA-common-pitfalls">å¸¸è§è¯¯åŒº (Common Pitfalls)</a></li><li><a href="#%E5%85%AB%E6%80%BB%E7%BB%93">æ€»ç»“</a></li></ol><br><h2 id="ä¸€ã€å¼•è¨€"><a href="#ä¸€ã€å¼•è¨€" class="headerlink" title="ä¸€ã€å¼•è¨€"></a><strong>ä¸€ã€å¼•è¨€</strong></h2><h3 id="1-1-ä¸ºä»€ä¹ˆéœ€è¦è·¯ç”±ï¼Ÿ-SPA-vs-MPA"><a href="#1-1-ä¸ºä»€ä¹ˆéœ€è¦è·¯ç”±ï¼Ÿ-SPA-vs-MPA" class="headerlink" title="1.1 ä¸ºä»€ä¹ˆéœ€è¦è·¯ç”±ï¼Ÿ (SPA vs MPA)"></a><strong><font color="red">1.1 ä¸ºä»€ä¹ˆéœ€è¦è·¯ç”±ï¼Ÿ (SPA vs MPA)</font></strong></h3><p>åœ¨ä¼ ç»Ÿçš„å¤šé¡µåº”ç”¨ (MPA) ä¸­ï¼Œæ¯æ¬¡ç‚¹å‡»é“¾æ¥ï¼Œæµè§ˆå™¨éƒ½ä¼šå‘æœåŠ¡å™¨è¯·æ±‚ä¸€ä¸ªæ–°çš„ HTML é¡µé¢ï¼Œå¯¼è‡´é¡µé¢åˆ·æ–°ï¼ˆç™½å±é—ªçƒï¼‰ã€‚</p><p><strong>React Router</strong> å¸®åŠ©æˆ‘ä»¬æ„å»º <strong>å•é¡µåº”ç”¨ (SPA)</strong>ï¼š</p><ol><li><strong>æ— åˆ·æ–°è·³è½¬</strong>ï¼šç‚¹å‡»é“¾æ¥æ—¶ï¼Œåªé€šè¿‡ JavaScript æ›´æ–°é¡µé¢å†…å®¹ï¼Œæ— éœ€é‡æ–°åŠ è½½æ•´ä¸ªé¡µé¢ã€‚</li><li><strong>ä½“éªŒå¦‚åŸç”Ÿåº”ç”¨</strong>ï¼šä¸æ»‘çš„é¡µé¢åˆ‡æ¢æ•ˆæœã€‚</li><li><strong>URL ä¸ UI åŒæ­¥</strong>ï¼šé€šè¿‡ URL (<code>/about</code>) ç›´æ¥å®šä½åˆ°ç‰¹å®šç»„ä»¶ (<code>&lt;About /&gt;</code>)ã€‚</li></ol><br><h3 id="1-2-React-Router-v6-4-Data-APIs"><a href="#1-2-React-Router-v6-4-Data-APIs" class="headerlink" title="1.2 React Router v6.4+ (Data APIs)"></a><strong><font color="red">1.2 React Router v6.4+ (Data APIs)</font></strong></h3><p>è¿™æ˜¯ React Router çš„ä¸€æ¬¡é©å‘½æ€§æ›´æ–°ï¼Œå¼•å…¥äº† <strong>Data APIs</strong>ã€‚è¿™ä¸ä»…æ˜¯å®šä¹‰è·¯ç”±çš„æ–°æ–¹å¼ï¼Œæ›´è§£å†³äº† React åº”ç”¨ä¸­å¸¸è§çš„â€œåŠ è½½ç€‘å¸ƒæµâ€é—®é¢˜ã€‚</p><p><strong>æ ¸å¿ƒä¼˜åŠ¿ï¼š</strong></p><ul><li><strong>å¹¶è¡ŒåŠ è½½</strong>ï¼šè·¯ç”±ä¸æ•°æ®è·å–å¹¶è¡Œè¿›è¡Œï¼Œæå¤§æå‡é¦–å±é€Ÿåº¦ã€‚</li><li><strong>é…ç½®åŒ–è·¯ç”±</strong>ï¼šä½¿ç”¨å¯¹è±¡æ•°ç»„ (<code>createBrowserRouter</code>) ç®¡ç†è·¯ç”±ï¼Œæ¯” JSX å†™æ³•æ›´æ¸…æ™°ã€æ›´æ˜“ç»´æŠ¤ã€‚</li><li><strong>è‡ªåŠ¨çŠ¶æ€ç®¡ç†</strong>ï¼šå†…ç½® <code>loading</code>ã€<code>error</code> çŠ¶æ€å¤„ç†ï¼Œå‡å°‘å¤§é‡æ ·æ¿ä»£ç ã€‚</li></ul><br><h3 id="1-3-React-Router-v7-ä¸‰ç§ä½¿ç”¨æ¨¡å¼"><a href="#1-3-React-Router-v7-ä¸‰ç§ä½¿ç”¨æ¨¡å¼" class="headerlink" title="1.3 React Router v7+ä¸‰ç§ä½¿ç”¨æ¨¡å¼"></a><strong><font color="red">1.3 React Router v7+ä¸‰ç§ä½¿ç”¨æ¨¡å¼</font></strong></h3><p>React Router çš„è¿™ä¸‰ç§æ¨¡å¼åæ˜ äº†å®ƒä»ä¸€ä¸ªç®€å•çš„ç»„ä»¶åº“æ¼”å˜ä¸ºåŠŸèƒ½å®Œå¤‡çš„æ•°æ®æ¡†æ¶çš„å†ç¨‹ã€‚</p><h3 id="1-ä¸‰ç§æ¨¡å¼çš„åŒºåˆ«"><a href="#1-ä¸‰ç§æ¨¡å¼çš„åŒºåˆ«" class="headerlink" title="1. ä¸‰ç§æ¨¡å¼çš„åŒºåˆ«"></a>1. ä¸‰ç§æ¨¡å¼çš„åŒºåˆ«</h3><table><thead><tr><th align="left">æ¨¡å¼</th><th align="left">æ ¸å¿ƒç†å¿µ</th><th align="left">ä½¿ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td align="left"><strong>Declarative (å£°æ˜å¼)</strong></td><td align="left">ä¼ ç»Ÿçš„ç»„ä»¶åŒ–è·¯ç”±ï¼Œä½¿ç”¨ <code>&lt;Routes&gt;</code> å’Œ <code>&lt;Route&gt;</code> ç›´æ¥å†™åœ¨ JSX ä¸­ã€‚</td><td align="left">ç®€å•çš„ CSR åº”ç”¨ï¼Œä¸éœ€è¦è·¯ç”±é©±åŠ¨çš„æ•°æ®é¢„åŠ è½½ã€‚</td></tr><tr><td align="left"><strong>Data (æ•°æ®é©±åŠ¨)</strong></td><td align="left"><strong>React Router v6.4+ æ¨èæ–¹å¼</strong>ã€‚ä½¿ç”¨ <code>createBrowserRouter</code> å®šä¹‰è·¯ç”±å¯¹è±¡ã€‚æ”¯æŒ <code>loader</code>ï¼ˆé¢„åŠ è½½æ•°æ®ï¼‰ã€<code>action</code>ï¼ˆæ•°æ®ä¿®æ”¹ï¼‰å’Œ <code>errorElement</code>ã€‚</td><td align="left">ä¸­å¤§å‹åº”ç”¨ï¼Œå¸Œæœ›é€šè¿‡è·¯ç”±å¹¶è¡ŒåŠ è½½æ•°æ®ã€å¤„ç†è¡¨å•æäº¤å’Œé”™è¯¯è¾¹ç•Œã€‚</td></tr><tr><td align="left"><strong>Framework (æ¡†æ¶æ¨¡å¼)</strong></td><td align="left"><strong>React Router v7 (åŸ Remix)</strong>ã€‚å°† React Router ä½œä¸ºå…¨æ ˆæ¡†æ¶ä½¿ç”¨ï¼Œå¤„ç† SSRï¼ˆæœåŠ¡ç«¯æ¸²æŸ“ï¼‰ã€é™æ€ç”Ÿæˆç­‰ã€‚</td><td align="left">éœ€è¦ SSRã€SEO ä¼˜åŒ–æˆ–å¤æ‚å…¨æ ˆé€»è¾‘çš„é¡¹ç›®ã€‚</td></tr></tbody></table><hr><br><h2 id="äºŒã€å¿«é€Ÿä¸Šæ‰‹-Data-Router"><a href="#äºŒã€å¿«é€Ÿä¸Šæ‰‹-Data-Router" class="headerlink" title="äºŒã€å¿«é€Ÿä¸Šæ‰‹ (Data Router)"></a><strong>äºŒã€å¿«é€Ÿä¸Šæ‰‹ (Data Router)</strong></h2><h3 id="2-1-å®‰è£…"><a href="#2-1-å®‰è£…" class="headerlink" title="2.1 å®‰è£…"></a><strong><font color="red">2.1 å®‰è£…</font></strong></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…æœ€æ–°ç‰ˆ React Router DOM (åŒ…å«äº†æ ¸å¿ƒ React Router)</span></span><br><span class="line">npm install react-router-dom</span><br></pre></td></tr></table></figure><blockquote><p><strong>æç¤º</strong>ï¼šå®‰è£…å®Œæˆåï¼Œæ£€æŸ¥ <code>package.json</code> ä¸­çš„ <code>dependencies</code>ï¼Œç¡®è®¤ç‰ˆæœ¬å· <code>&gt;= 6.4</code>ã€‚</p></blockquote><br><h3 id="2-2-åŸºæœ¬ä½¿ç”¨"><a href="#2-2-åŸºæœ¬ä½¿ç”¨" class="headerlink" title="2.2 åŸºæœ¬ä½¿ç”¨"></a><strong><font color="red">2.2 åŸºæœ¬ä½¿ç”¨</font></strong></h3><p>ä¸ä¼ ç»Ÿçš„ç»„ä»¶å¼ (<code>&lt;BrowserRouter&gt;</code>) ä¸åŒï¼Œæ–°ç‰ˆæ¨èä½¿ç”¨å¯¹è±¡é…ç½®ã€‚</p><p><strong><code>src\router\index.js</code></strong></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createBrowserRouter &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. åˆ›å»ºè·¯ç”±å™¨å®ä¾‹ (Router Instance)</span></span><br><span class="line"><span class="comment">// è¿™é‡Œå®šä¹‰äº† URL è·¯å¾„ä¸ React ç»„ä»¶çš„æ˜ å°„å…³ç³»</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createBrowserRouter</span>([</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/&quot;</span>, <span class="comment">// è®¿é—®æ ¹è·¯å¾„ http://localhost:5173/ æ—¶</span></span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Hello world!<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>, <span class="comment">// æ¸²æŸ“è¿™ä¸ª JSX</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/about&quot;</span>, <span class="comment">// è®¿é—® http://localhost:5173/about æ—¶</span></span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>About<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>, <span class="comment">// æ¸²æŸ“ About ç»„ä»¶</span></span><br><span class="line">  &#125;,</span><br><span class="line">]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router;</span><br></pre></td></tr></table></figure><p><strong><code>src\App.jsx</code></strong></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">RouterProvider</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&quot;./router&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">	&#123;<span class="comment">/* RouterProvider ç»„ä»¶ç”¨äºåŒ…è£¹æ•´ä¸ªåº”ç”¨æˆ–è·¯ç”±éƒ¨åˆ†ï¼Œèƒ½ç›´æ¥ç”Ÿæˆè·¯ç”±ç•Œé¢ */</span>&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">RouterProvider</span> <span class="attr">router</span>=<span class="string">&#123;router&#125;</span> /&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><br><h2 id="ä¸‰ã€è·¯ç”±æ ¸å¿ƒåŸºç¡€-Routing"><a href="#ä¸‰ã€è·¯ç”±æ ¸å¿ƒåŸºç¡€-Routing" class="headerlink" title="ä¸‰ã€è·¯ç”±æ ¸å¿ƒåŸºç¡€ (Routing)"></a><strong>ä¸‰ã€è·¯ç”±æ ¸å¿ƒåŸºç¡€ (Routing)</strong></h2><h3 id="3-1-æ•°æ®åŠ è½½-Loader"><a href="#3-1-æ•°æ®åŠ è½½-Loader" class="headerlink" title="3.1 æ•°æ®åŠ è½½ (Loader)"></a><strong><font color="red">3.1 æ•°æ®åŠ è½½ (Loader)</font></strong></h3><blockquote><p><strong>æ³¨æ„</strong>: è¿™é‡Œå±•ç¤ºçš„æ˜¯åŸºç¡€æ¦‚å¿µï¼Œæ›´æ·±å…¥çš„ Data API ç”¨æ³•è¯·å‚è€ƒ <a href="#%E5%9B%9B-data-api-%E8%BF%9B%E9%98%B6">ç¬¬å››ç«  Data API</a>ã€‚</p></blockquote><p>è¿™æ˜¯ Data APIs çš„åŸºç¡€åŠŸèƒ½ã€‚å®ƒå…è®¸è·¯ç”±åœ¨æ¸²æŸ“ç»„ä»¶<strong>ä¹‹å‰</strong>å¹¶è¡ŒåŠ è½½æ•°æ®ï¼Œå½»åº•è§£å†³äº† React åº”ç”¨ä¸­å¸¸è§çš„â€œç€‘å¸ƒæµåŠ è½½â€é—®é¢˜ã€‚</p><p><strong><font color="#00A6ED">ä¸ºä»€ä¹ˆä½¿ç”¨ loader è€Œä¸æ˜¯ verifyEffectï¼Ÿ</font></strong></p><ul><li><strong>ä¼ ç»Ÿæ–¹å¼ (useEffect)</strong>: <code>åŠ è½½ç»„ä»¶ JS</code> -&gt; <code>æ¸²æŸ“ç»„ä»¶(Loading)</code> -&gt; <code>å‘èµ· Fetch</code> -&gt; <code>ç­‰å¾…æ•°æ®</code> -&gt; <code>æ¸²æŸ“çœŸå®å†…å®¹</code>ã€‚</li><li><strong>Loader æ–¹å¼</strong>: <code>ç‚¹å‡»é“¾æ¥</code> -&gt; <code>å¹¶è¡ŒåŠ è½½ç»„ä»¶ JS å’Œæ•°æ®</code> -&gt; <code>æ¸²æŸ“çœŸå®å†…å®¹</code>ã€‚</li></ul><p><strong>ä»£ç å®ç°ï¼š</strong></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. å®šä¹‰æ•°æ®åŠ è½½å‡½æ•° (Loader)</span></span><br><span class="line"><span class="comment">// è¯¥å‡½æ•°ä¼šåœ¨è·¯ç”±è·³è½¬æ—¶è‡ªåŠ¨æ‰§è¡Œï¼Œæ”¯æŒå¼‚æ­¥æ“ä½œ</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">homeLoader</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&quot;/api/user&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> (!res.<span class="property">ok</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;Failed to load&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> res.<span class="title function_">json</span>(); <span class="comment">// è¿”å›çš„æ•°æ®å¯ä»¥åœ¨ç»„ä»¶ä¸­é€šè¿‡ useLoaderData è·å–</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. åœ¨è·¯ç”±é…ç½®ä¸­ç»‘å®š</span></span><br><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/&quot;</span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Home</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">loader</span>: homeLoader, <span class="comment">// &lt;--- ç»‘å®š loader</span></span><br><span class="line">    <span class="attr">errorElement</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ErrorPage</span> /&gt;</span></span>, <span class="comment">// è‡ªåŠ¨æ•è· loader æŠ›å‡ºçš„é”™è¯¯</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/user/:id&quot;</span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">User</span> /&gt;</span></span>,</span><br><span class="line">    <span class="comment">// loader å‡½æ•°æ¥æ”¶ä¸€ä¸ª params å¯¹è±¡</span></span><br><span class="line">    <span class="attr">loader</span>: <span class="title function_">async</span> (&#123; params &#125;) =&gt; &#123;</span><br><span class="line">      <span class="keyword">const</span> response = <span class="title function_">fetch</span>(<span class="string">`/api/user/<span class="subst">$&#123;params.id&#125;</span>`</span>);</span><br><span class="line">      <span class="keyword">return</span> response.<span class="title function_">json</span>()</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/detail/:id&quot;</span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Detail</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">loader</span>: <span class="title function_">async</span> (&#123; params &#125;) =&gt; &#123;</span><br><span class="line">      <span class="keyword">const</span> response = <span class="title function_">fetch</span>(<span class="string">`/api/user/<span class="subst">$&#123;params.id&#125;</span>`</span>);</span><br><span class="line">      <span class="keyword">const</span> res = response.<span class="title function_">json</span>()</span><br><span class="line">      <span class="keyword">if</span>(!res.<span class="property">token</span>) &#123; <span class="comment">// é‡å®šå‘</span></span><br><span class="line">          <span class="keyword">throw</span> <span class="title function_">redirect</span>(<span class="string">&#x27;/login&#x27;</span>)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">return</span> res</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure><p><strong>åœ¨ç»„ä»¶ä¸­è·å–æ•°æ®ï¼š</strong></p><p>ç»„ä»¶å†…éƒ¨æ— éœ€å¤„ç† <code>loading</code> çŠ¶æ€ï¼Œå› ä¸º loader æ‰§è¡Œå®Œæ‰ä¼šæ¸²æŸ“ç»„ä»¶ï¼ˆé™¤éä½¿ç”¨äº† <code>defer</code>ï¼‰ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useLoaderData &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Home</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> user = <span class="title function_">useLoaderData</span>(); <span class="comment">//ç›´æ¥è·å– loader è¿”å›çš„æ•°æ®</span></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Welcome, &#123;user.name&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><h3 id="3-2-è·¯ç”±è·³è½¬-Navigation"><a href="#3-2-è·¯ç”±è·³è½¬-Navigation" class="headerlink" title="3.2 è·¯ç”±è·³è½¬ (Navigation)"></a><strong><font color="red">3.2 è·¯ç”±è·³è½¬ (Navigation)</font></strong></h3><p>React Router æä¾›äº†ä¸¤ç§ä¸»è¦çš„è·³è½¬æ–¹å¼ï¼šå£°æ˜å¼å’Œç¼–ç¨‹å¼ã€‚</p><h4 id="1ï¼‰å£°æ˜å¼è·³è½¬"><a href="#1ï¼‰å£°æ˜å¼è·³è½¬" class="headerlink" title="1ï¼‰å£°æ˜å¼è·³è½¬"></a><strong><font color="#10c300">1ï¼‰å£°æ˜å¼è·³è½¬</font></strong></h4><p>ç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢ä¸­çš„å¯¼èˆªé“¾æ¥ï¼Œç±»ä¼¼äº HTML çš„ <code>&lt;a&gt;</code> æ ‡ç­¾ï¼Œä½†ä¸ä¼šåˆ·æ–°é¡µé¢ã€‚</p><ul><li><strong><code>&lt;Link&gt;</code></strong>: åŸºç¡€é“¾æ¥ç»„ä»¶ã€‚</li><li><strong><code>&lt;NavLink&gt;</code></strong>: ç‰¹æ®Šçš„ Linkï¼Œè‡ªåŠ¨æ„ŸçŸ¥æ˜¯å¦å¤„äºæ¿€æ´»çŠ¶æ€ï¼ˆå¸¸ç”¨äºèœå•ï¼‰ã€‚</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Link</span>, <span class="title class_">NavLink</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Menu</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">nav</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;/* åŸºç¡€è·³è½¬ */&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;/about&quot;</span>&gt;</span>å…³äºæˆ‘ä»¬<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      &#123;/* å¸¦æœ‰æ¿€æ´»æ ·å¼çš„è·³è½¬ (Active Style) */&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">NavLink</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">to</span>=<span class="string">&quot;/home&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">className</span>=<span class="string">&#123;(&#123;</span> <span class="attr">isActive</span> &#125;) =&gt;</span> (isActive ? &quot;active&quot; : &quot;&quot;)&#125;</span></span><br><span class="line"><span class="language-xml">      &gt;</span></span><br><span class="line"><span class="language-xml">        é¦–é¡µ</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">NavLink</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      &#123;/* replace: æ›¿æ¢å½“å‰å†å²è®°å½•ï¼Œä¸ç•™ç—•è¿¹ */&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;/login&quot;</span> <span class="attr">replace</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        ç™»å½• (Replace)</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2ï¼‰ç¼–ç¨‹å¼è·³è½¬"><a href="#2ï¼‰ç¼–ç¨‹å¼è·³è½¬" class="headerlink" title="2ï¼‰ç¼–ç¨‹å¼è·³è½¬"></a><strong><font color="#10c300">2ï¼‰ç¼–ç¨‹å¼è·³è½¬</font></strong></h4><p><code>useNavigate</code>åœ¨äº‹ä»¶å¤„ç†å‡½æ•° (Event Handler) æˆ–å‰¯ä½œç”¨ (Effect) ä¸­æ‰§è¡Œè·³è½¬ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useNavigate &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">LoginPage</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> navigate = <span class="title function_">useNavigate</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleLogin</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// åŸºç¡€è·³è½¬</span></span><br><span class="line">    <span class="title function_">navigate</span>(<span class="string">&quot;/dashboard&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ›¿æ¢æ¨¡å¼ (Replace)</span></span><br><span class="line">    <span class="title function_">navigate</span>(<span class="string">&quot;/home&quot;</span>, &#123; <span class="attr">replace</span>: <span class="literal">true</span> &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åé€€/å‰è¿›</span></span><br><span class="line">    <span class="title function_">navigate</span>(-<span class="number">1</span>); <span class="comment">// åé€€ä¸€æ­¥</span></span><br><span class="line">    <span class="title function_">navigate</span>(<span class="number">1</span>); <span class="comment">// å‰è¿›ä¸€æ­¥</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleLogin&#125;</span>&gt;</span>ç™»å½•<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><h3 id="3-3-å‚æ•°ä¼ é€’-Params"><a href="#3-3-å‚æ•°ä¼ é€’-Params" class="headerlink" title="3.3 å‚æ•°ä¼ é€’ (Params)"></a><strong><font color="red">3.3 å‚æ•°ä¼ é€’ (Params)</font></strong></h3><p>è¿™æ˜¯å¼€å‘ä¸­æœ€å¸¸è§çš„éœ€æ±‚ï¼ŒReact Router æ”¯æŒä¸‰ç§ä¸»è¦çš„ä¼ å‚æ–¹å¼ã€‚</p><h4 id="1ï¼‰è·¯å¾„å‚æ•°-Path-Params"><a href="#1ï¼‰è·¯å¾„å‚æ•°-Path-Params" class="headerlink" title="1ï¼‰è·¯å¾„å‚æ•° (Path Params)"></a><strong><font color="#10c300">1ï¼‰è·¯å¾„å‚æ•° (Path Params)</font></strong></h4><p>å‚æ•°ç›´æ¥æ‹¼æ¥åœ¨ URL ä¸­ï¼Œå¦‚ <code>/user/123</code>ã€‚</p><ul><li><strong>ä¼˜ç‚¹</strong>ï¼šåˆ·æ–°é¡µé¢å‚æ•°ä¸ä¸¢å¤±ï¼Œè¯­ä¹‰æ¸…æ™°ã€‚</li><li><strong>å®šä¹‰</strong>ï¼šéœ€è¦åœ¨è·¯ç”±é…ç½®ä¸­å®šä¹‰å ä½ç¬¦ <code>:id</code>ã€‚</li></ul><p><strong>1ï¸âƒ£è·¯ç”±å®šä¹‰ï¼š</strong></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// router/index.jsx</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">path</span>: <span class="string">&quot;/user/:id&quot;</span>, <span class="comment">// :id æ˜¯å‚æ•°å ä½ç¬¦</span></span><br><span class="line">  <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UserPage</span> /&gt;</span></span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>2ï¸âƒ£è·³è½¬ä¼ å‚ï¼š</strong></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Link</span> to=<span class="string">&quot;/user/123&quot;</span>&gt;æŸ¥çœ‹ç”¨æˆ· <span class="number">123</span>&lt;/<span class="title class_">Link</span>&gt;;</span><br><span class="line"><span class="comment">// æˆ–è€…</span></span><br><span class="line"><span class="title function_">navigate</span>(<span class="string">&quot;/user/123&quot;</span>);</span><br></pre></td></tr></table></figure><p><strong>3ï¸âƒ£è·å–å‚æ•°ï¼š</strong></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useParams &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">UserPage</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; id &#125; = <span class="title function_">useParams</span>(); <span class="comment">// è·å–åˆ°çš„ id ä¸º string ç±»å‹ &quot;123&quot;</span></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>User ID: &#123;id&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2ï¼‰æŸ¥è¯¢å‚æ•°-Query-Params"><a href="#2ï¼‰æŸ¥è¯¢å‚æ•°-Query-Params" class="headerlink" title="2ï¼‰æŸ¥è¯¢å‚æ•° (Query Params)"></a><strong><font color="#10c300">2ï¼‰æŸ¥è¯¢å‚æ•° (Query Params)</font></strong></h4><p>å‚æ•°ä»¥ key&#x3D;value å½¢å¼æ‹¼æ¥åœ¨ ? åï¼Œå¦‚ <code>/list?page=1&amp;sort=desc</code>ã€‚</p><ul><li><strong>ä¼˜ç‚¹</strong>ï¼šæ— éœ€ä¿®æ”¹è·¯ç”±å®šä¹‰ï¼Œçµæ´»å¤šå˜ã€‚</li></ul><p><strong>1ï¸âƒ£è·³è½¬ä¼ å‚ï¼š</strong></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Link</span> to=<span class="string">&quot;/list?page=1&amp;sort=desc&quot;</span>&gt;å•†å“åˆ—è¡¨&lt;/<span class="title class_">Link</span>&gt;;</span><br><span class="line"><span class="comment">// æˆ–è€…</span></span><br><span class="line"><span class="title function_">navigate</span>(<span class="string">&quot;/list?page=1&amp;sort=desc&quot;</span>);</span><br></pre></td></tr></table></figure><p><strong>2ï¸âƒ£è·å–å‚æ•°ï¼š</strong></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useSearchParams &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ListPage</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [searchParams, setSearchParams] = <span class="title function_">useSearchParams</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è·å–</span></span><br><span class="line">  <span class="keyword">const</span> page = searchParams.<span class="title function_">get</span>(<span class="string">&quot;page&quot;</span>); <span class="comment">// &quot;1&quot;</span></span><br><span class="line">  <span class="keyword">const</span> sort = searchParams.<span class="title function_">get</span>(<span class="string">&quot;sort&quot;</span>); <span class="comment">// &quot;desc&quot;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä¿®æ”¹ (è¿™ä¼šæ›´æ–° URL å¹¶é‡æ–°æ¸²æŸ“ç»„ä»¶)</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">changeSort</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">setSearchParams</span>(&#123; <span class="attr">page</span>: <span class="number">1</span>, <span class="attr">sort</span>: <span class="string">&quot;asc&quot;</span> &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Page: &#123;page&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3ï¼‰éšå¼çŠ¶æ€-State"><a href="#3ï¼‰éšå¼çŠ¶æ€-State" class="headerlink" title="3ï¼‰éšå¼çŠ¶æ€ (State)"></a><strong><font color="#10c300">3ï¼‰éšå¼çŠ¶æ€ (State)</font></strong></h4><p>å‚æ•°ä¸æ˜¾ç¤ºåœ¨ URL ä¸­ï¼Œå­˜å‚¨åœ¨ history state å¯¹è±¡é‡Œã€‚</p><ul><li><strong>ä¼˜ç‚¹</strong>ï¼šå¯ä¼ é€’å¯¹è±¡ã€æ•°ç»„ç­‰å¤æ‚æ•°æ®ï¼ŒURL å¹²å‡€ã€‚</li><li><strong>ç¼ºç‚¹</strong>ï¼š<strong>åˆ·æ–°é¡µé¢ä¸ä¸¢å¤±</strong>ï¼ˆå¾ˆå¤šè¯¯åŒºè®¤ä¸ºä¼šä¸¢å¤±ï¼Œå®é™…ä¸Š History State åˆ·æ–°åä¾ç„¶å­˜åœ¨ï¼‰ï¼Œä½†<strong>å¤åˆ¶é“¾æ¥ç»™åˆ«äººä¼šä¸¢å¤±æ•°æ®</strong>ã€‚</li></ul><p><strong>1ï¸âƒ£è·³è½¬ä¼ å‚ï¼š</strong></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Link</span> to=<span class="string">&quot;/profile&quot;</span> state=&#123;&#123; <span class="attr">role</span>: <span class="string">&quot;admin&quot;</span>, <span class="attr">code</span>: <span class="number">9527</span> &#125;&#125;&gt;</span><br><span class="line">  ä¸ªäººä¸­å¿ƒ</span><br><span class="line">&lt;/<span class="title class_">Link</span>&gt;;</span><br><span class="line"><span class="comment">// æˆ–è€…</span></span><br><span class="line"><span class="title function_">navigate</span>(<span class="string">&quot;/profile&quot;</span>, &#123; <span class="attr">state</span>: &#123; <span class="attr">role</span>: <span class="string">&quot;admin&quot;</span>, <span class="attr">code</span>: <span class="number">9527</span> &#125; &#125;);</span><br></pre></td></tr></table></figure><p><strong>2ï¸âƒ£è·å–å‚æ•°ï¼š</strong></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useLocation &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ProfilePage</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> location = <span class="title function_">useLocation</span>();</span><br><span class="line">  <span class="keyword">const</span> &#123; role, code &#125; = location.<span class="property">state</span> || &#123;&#125;; <span class="comment">// è®°å¾—å¤„ç†ç©ºå€¼ï¼Œé˜²æ­¢ç›´æ¥è®¿é—®æŠ¥é”™</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Role: &#123;role&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><h3 id="3-4-åµŒå¥—è·¯ç”±ä¸-Outlet"><a href="#3-4-åµŒå¥—è·¯ç”±ä¸-Outlet" class="headerlink" title="3.4 åµŒå¥—è·¯ç”±ä¸ Outlet"></a><strong><font color="red">3.4 åµŒå¥—è·¯ç”±ä¸ Outlet</font></strong></h3><p>åµŒå¥—è·¯ç”±æ˜¯ React Router æœ€æ ¸å¿ƒã€æœ€å¼ºå¤§çš„åŠŸèƒ½ã€‚å®ƒè®©æˆ‘ä»¬èƒ½å¤Ÿå°† UI çš„åµŒå¥—ç»“æ„ä¸ URL çš„è·¯å¾„ç»“æ„å®Œç¾å¯¹åº”ã€‚</p><h4 id="1ï¼‰ä»€ä¹ˆæ˜¯åµŒå¥—è·¯ç”±ï¼Ÿ"><a href="#1ï¼‰ä»€ä¹ˆæ˜¯åµŒå¥—è·¯ç”±ï¼Ÿ" class="headerlink" title="1ï¼‰ä»€ä¹ˆæ˜¯åµŒå¥—è·¯ç”±ï¼Ÿ"></a><strong><font color="#10c300">1ï¼‰ä»€ä¹ˆæ˜¯åµŒå¥—è·¯ç”±ï¼Ÿ</font></strong></h4><p>åœ¨å¤§å¤šæ•°åº”ç”¨ä¸­ï¼Œç•Œé¢é€šå¸¸æ˜¯ç”±å¤šå±‚åµŒå¥—çš„ç»„ä»¶ç»„æˆçš„ã€‚ä¾‹å¦‚ï¼š</p><ul><li><strong>URL</strong>: <code>/dashboard/settings</code></li><li><strong>UI</strong>: é¡µé¢æ•´ä½“ -&gt; ä¾§è¾¹æ å¸ƒå±€ (<code>Parent</code>) -&gt; è®¾ç½®é¢æ¿ (<code>Child</code>)</li></ul><p>React Router é€šè¿‡ <strong>åµŒå¥—è·¯ç”±</strong> è‡ªåŠ¨å¸®æˆ‘ä»¬å°†è¿™ç§ URL æ˜ å°„ä¸ºç»„ä»¶å±‚çº§ï¼š<br><code>/dashboard</code> -&gt; æ¸²æŸ“ <code>&lt;DashboardLayout /&gt;</code><br><code>/dashboard/settings</code> -&gt; åœ¨ <code>&lt;DashboardLayout&gt;</code> å†…éƒ¨æ¸²æŸ“ <code>&lt;Settings /&gt;</code></p><h4 id="2ï¼‰åµŒå¥—é…ç½®"><a href="#2ï¼‰åµŒå¥—é…ç½®" class="headerlink" title="2ï¼‰åµŒå¥—é…ç½®"></a><strong><font color="#10c300">2ï¼‰åµŒå¥—é…ç½®</font></strong></h4><p>æˆ‘ä»¬åœ¨è·¯ç”±é…ç½®ä¸­ä½¿ç”¨ <code>children</code> æ•°ç»„æ¥å®šä¹‰å­è·¯ç”±ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/router/index.jsx</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createBrowserRouter</span>([</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/dashboard&quot;</span>, <span class="comment">// 1. çˆ¶è·¯ç”±è·¯å¾„</span></span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">DashboardLayout</span> /&gt;</span></span>, <span class="comment">// 2. çˆ¶ç»„ä»¶ï¼ˆé€šå¸¸æ˜¯å¸ƒå±€æ–‡ä»¶ï¼‰</span></span><br><span class="line">    <span class="comment">// 3. å®šä¹‰å­è·¯ç”±æ•°ç»„</span></span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">index</span>: <span class="literal">true</span>, <span class="comment">// é»˜è®¤å­è·¯ç”± (è®¿é—® /dashboard æ—¶æ˜¾ç¤ºï¼Œé»˜è®¤å­è·¯ç”±é‡Œé¢ä¸èƒ½å†åµŒå¥—å­è·¯ç”±)</span></span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Stats</span> /&gt;</span></span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&quot;settings&quot;</span>, <span class="comment">// å­è·¯ç”±è·¯å¾„ (æ³¨æ„ï¼šä¸è¦åŠ  / )</span></span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Settings</span> /&gt;</span></span>, <span class="comment">// è®¿é—® /dashboard/settings æ—¶æ˜¾ç¤º</span></span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">]);</span><br></pre></td></tr></table></figure><h4 id="3ï¼‰çˆ¶ç»„ä»¶å¦‚ä½•æ¸²æŸ“å­è·¯ç”±ï¼Ÿ"><a href="#3ï¼‰çˆ¶ç»„ä»¶å¦‚ä½•æ¸²æŸ“å­è·¯ç”±ï¼Ÿ" class="headerlink" title="3ï¼‰çˆ¶ç»„ä»¶å¦‚ä½•æ¸²æŸ“å­è·¯ç”±ï¼Ÿ"></a><strong><font color="#10c300">3ï¼‰çˆ¶ç»„ä»¶å¦‚ä½•æ¸²æŸ“å­è·¯ç”±ï¼Ÿ</font></strong></h4><p>å…‰é…ç½®äº†è·¯ç”±è¿˜ä¸å¤Ÿï¼Œ<strong>çˆ¶ç»„ä»¶å¿…é¡»æ˜ç¡®æŒ‡å®šâ€œå­ç»„ä»¶æ˜¾ç¤ºåœ¨å“ªé‡Œâ€</strong>ã€‚å¦‚æœä¸å†™ <code>&lt;Outlet /&gt;</code>ï¼Œå­è·¯ç”±çš„å†…å®¹å°†ä¸ä¼šæ¸²æŸ“ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/layouts/DashboardLayout.jsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Outlet</span>, <span class="title class_">Link</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">DashboardLayout</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;layout&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;/* ä¾§è¾¹æ å¯¼èˆª (å§‹ç»ˆæ˜¾ç¤º) */&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">nav</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;/dashboard&quot;</span>&gt;</span>æ¦‚è§ˆ<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;/dashboard/settings&quot;</span>&gt;</span>è®¾ç½®<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">main</span> <span class="attr">className</span>=<span class="string">&quot;content&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* ğŸ”¥ å…³é”®ç‚¹ï¼šå­è·¯ç”±åŒ¹é…åˆ°çš„ç»„ä»¶ (Stats æˆ– Settings) å°†ä¼šå¡«å…¥è¿™ä¸ªä½ç½® */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Outlet</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">main</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4ï¼‰æ€»ç»“ï¼šè·¯ç”±åŒ¹é…æµç¨‹"><a href="#4ï¼‰æ€»ç»“ï¼šè·¯ç”±åŒ¹é…æµç¨‹" class="headerlink" title="4ï¼‰æ€»ç»“ï¼šè·¯ç”±åŒ¹é…æµç¨‹"></a><strong><font color="#10c300">4ï¼‰æ€»ç»“ï¼šè·¯ç”±åŒ¹é…æµç¨‹</font></strong></h4><p>å½“ç”¨æˆ·è®¿é—® <code>/dashboard/settings</code> æ—¶ï¼š</p><ol><li>React Router åŒ¹é…åˆ° <code>/dashboard</code> -&gt; æ¸²æŸ“ <code>&lt;DashboardLayout&gt;</code>ã€‚</li><li>React Router ç»§ç»­åŒ¹é… <code>settings</code> -&gt; æ‰¾åˆ° <code>&lt;Settings&gt;</code> ç»„ä»¶ã€‚</li><li>å®ƒå°† <code>&lt;Settings&gt;</code> ç»„ä»¶ä½œä¸º children ä¼ é€’ç»™ <code>&lt;Outlet /&gt;</code>ï¼Œæœ€ç»ˆé¡µé¢ç»“æ„å¦‚ä¸‹ï¼š</li></ol><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">DashboardLayout</span>&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">nav</span>&gt;</span>...<span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">main</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">Settings</span> /&gt;</span> &#123;/* &lt;-- è¿™é‡Œå°±æ˜¯ Outlet æ¸²æŸ“çš„å†…å®¹ */&#125;</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">main</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">DashboardLayout</span>&gt;</span></span></span><br></pre></td></tr></table></figure><br><h3 id="3-5-è·¯ç”±æ‡’åŠ è½½"><a href="#3-5-è·¯ç”±æ‡’åŠ è½½" class="headerlink" title="3.5 è·¯ç”±æ‡’åŠ è½½"></a><strong><font color="red">3.5 è·¯ç”±æ‡’åŠ è½½</font></strong></h3><p>éšç€åº”ç”¨è§„æ¨¡çš„å¢é•¿ï¼Œæ‰“åŒ…åçš„ JavaScript æ–‡ä»¶ï¼ˆChunkï¼‰ä¼šå˜å¾—è¶Šæ¥è¶Šå¤§ï¼Œå¯¼è‡´é¦–å±åŠ è½½ç¼“æ…¢ã€‚ <strong>è·¯ç”±æ‡’åŠ è½½</strong> æ˜¯ä¼˜åŒ– React åº”ç”¨æ€§èƒ½çš„å…³é”®æ‰‹æ®µã€‚</p><h4 id="1ï¼‰ä¸ºä»€ä¹ˆè¦æ‡’åŠ è½½ï¼Ÿ"><a href="#1ï¼‰ä¸ºä»€ä¹ˆè¦æ‡’åŠ è½½ï¼Ÿ" class="headerlink" title="1ï¼‰ä¸ºä»€ä¹ˆè¦æ‡’åŠ è½½ï¼Ÿ"></a><strong><font color="#10c300">1ï¼‰ä¸ºä»€ä¹ˆè¦æ‡’åŠ è½½ï¼Ÿ</font></strong></h4><ul><li><strong>é»˜è®¤è¡Œä¸º</strong>ï¼šæ„å»ºå·¥å…·ï¼ˆå¦‚ Viper&#x2F;Webpackï¼‰ä¼šå°†æ‰€æœ‰é¡µé¢ç»„ä»¶æ‰“åŒ…è¿›ä¸€ä¸ªå·¨å¤§çš„ JS æ–‡ä»¶ä¸­ã€‚å³ä½¿æœ‰äº›é¡µé¢ç”¨æˆ·å¯èƒ½æ°¸è¿œä¸ä¼šè®¿é—®ï¼Œæµè§ˆå™¨ä¹Ÿå¿…é¡»å…ˆä¸‹è½½è¿™äº›ä»£ç ã€‚</li><li><strong>æ‡’åŠ è½½è¡Œä¸º</strong>ï¼šå°†ä»£ç åˆ†å‰²æˆå¤šä¸ªå°å—ï¼ˆChunksï¼‰ã€‚<strong>åªæœ‰å½“ç”¨æˆ·ç‚¹å‡»è·³è½¬åˆ°ç‰¹å®šè·¯ç”±æ—¶</strong>ï¼Œæµè§ˆå™¨æ‰å»ä¸‹è½½è¯¥é¡µé¢å¯¹åº”çš„ JS ä»£ç ã€‚</li></ul><h4 id="2ï¼‰æ ¸å¿ƒ-APIï¼šReact-lazy-Suspense"><a href="#2ï¼‰æ ¸å¿ƒ-APIï¼šReact-lazy-Suspense" class="headerlink" title="2ï¼‰æ ¸å¿ƒ APIï¼šReact.lazy &amp; Suspense"></a><strong><font color="#10c300">2ï¼‰æ ¸å¿ƒ APIï¼šReact.lazy &amp; Suspense</font></strong></h4><p>React åŸç”Ÿæä¾›äº† <code>lazy</code> å‡½æ•°æ¥å®ç°åŠ¨æ€å¯¼å…¥ï¼Œé…åˆ <code>Suspense</code> ç»„ä»¶å¤„ç†åŠ è½½çŠ¶æ€ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; lazy, <span class="title class_">Suspense</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; createBrowserRouter &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. ä½¿ç”¨ lazy åŠ¨æ€å¯¼å…¥ç»„ä»¶ (æ³¨æ„ï¼šä¸è¦åœ¨ç»„ä»¶å†…éƒ¨å£°æ˜)</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">About</span> = <span class="title function_">lazy</span>(<span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;./pages/About&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//  2. ä½¿ç”¨ Suspense åŒ…è£¹æ‡’åŠ è½½ç»„ä»¶ï¼Œfallback ç”¨äºæ˜¾ç¤ºåŠ è½½ä¸­çŠ¶æ€</span></span><br><span class="line"><span class="comment">// æ–¹å¼1ï¼š</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createBrowserRouter</span>([</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/about&quot;</span>,</span><br><span class="line">    <span class="attr">element</span>: (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">Suspense</span> <span class="attr">fallback</span>=<span class="string">&#123;</span>&lt;<span class="attr">div</span>&gt;</span>Loading...<span class="tag">&lt;/<span class="name">div</span>&gt;</span>&#125;&gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">About</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Suspense</span>&gt;</span></span></span><br><span class="line">    ),</span><br><span class="line">  &#125;,</span><br><span class="line">]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–¹å¼2ï¼šå°è£… Suspens(HOCé«˜é˜¶å‡½æ•°)</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">withSuspense</span> = (<span class="params">Component</span>) =&gt; (</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">Suspense</span> <span class="attr">fallback</span>=<span class="string">&#123;</span>&lt;<span class="attr">Loading</span> /&gt;</span>&#125;&gt;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">Component</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">Suspense</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createBrowserRouter</span>([</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/about&quot;</span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="title function_">withSuspense</span>(<span class="title class_">About</span>),</span><br><span class="line">  &#125;,</span><br><span class="line">]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–¹å¼3ï¼šå¯åœ¨æ•´ä¸ªè·¯ç”±å…¥å£ä½¿ç”¨Suspense åŒ…è£¹æ‰€æœ‰è·¯ç”±ç»„ä»¶(å‰æå…¨éƒ¨è·¯ç”±æ‡’åŠ è½½)</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">Suspense</span> <span class="attr">fallback</span>=<span class="string">&#123;</span>&lt;<span class="attr">div</span>&gt;</span>Loading...<span class="tag">&lt;/<span class="name">div</span>&gt;</span>&#125;&gt;</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">RouterProvider</span> <span class="attr">router</span>=<span class="string">&#123;router&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">Suspense</span>&gt;</span></span>;</span><br></pre></td></tr></table></figure><blockquote><p><strong>æ³¨æ„</strong>ï¼šå¦‚æœä¸ä½¿ç”¨ <code>Suspense</code> åŒ…è£¹ï¼ŒReact åœ¨ç­‰å¾…ç»„ä»¶åŠ è½½æ—¶ä¼šæŠ›å‡ºé”™è¯¯ï¼Œå¯¼è‡´åº”ç”¨å´©æºƒã€‚</p></blockquote><br><h3 id="3-6-è·¯ç”±æ¨¡å¼"><a href="#3-6-è·¯ç”±æ¨¡å¼" class="headerlink" title="3.6 è·¯ç”±æ¨¡å¼"></a><strong><font color="red">3.6 è·¯ç”±æ¨¡å¼</font></strong></h3><p>React Router ä¸»è¦æ”¯æŒä¸¤ç§è·¯ç”±æ¨¡å¼ï¼š<strong>History æ¨¡å¼</strong> å’Œ <strong>Hash æ¨¡å¼</strong>ã€‚åœ¨ Data API (v6.4+) ä¸­ï¼Œå®ƒä»¬åˆ†åˆ«å¯¹åº” <code>createBrowserRouter</code> å’Œ <code>createHashRouter</code>ã€‚</p><h4 id="1ï¼‰History-æ¨¡å¼-æ¨è"><a href="#1ï¼‰History-æ¨¡å¼-æ¨è" class="headerlink" title="1ï¼‰History æ¨¡å¼ (æ¨è)"></a><strong><font color="#10c300">1ï¼‰History æ¨¡å¼ (æ¨è)</font></strong></h4><p>è¿™æ˜¯ç°ä»£ Web åº”ç”¨çš„æ ‡å‡†æ¨¡å¼ï¼Œä½¿ç”¨ HTML5 History API (<code>pushState</code>, <code>replaceState</code>) æ¥ç®¡ç† URLã€‚</p><ul><li><strong>è¡¨ç°</strong>ï¼šURL çœ‹èµ·æ¥åƒæ ‡å‡†çš„è·¯å¾„ï¼Œä¾‹å¦‚ <code>example.com/user/123</code>ã€‚</li><li><strong>ä¼˜ç‚¹</strong>ï¼šURL ç¾è§‚ï¼Œç¬¦åˆç”¨æˆ·ä¹ æƒ¯ï¼›SEO å‹å¥½ã€‚</li><li><strong>ç¼ºç‚¹</strong>ï¼š<strong>éœ€è¦æœåŠ¡å™¨é…ç½®æ”¯æŒ</strong>ã€‚å› ä¸ºæ˜¯å•é¡µåº”ç”¨ï¼Œå½“ç”¨æˆ·ç›´æ¥è®¿é—®æ·±å±‚è·¯å¾„ï¼ˆå¦‚ <code>/user/123</code>ï¼‰æˆ–åˆ·æ–°é¡µé¢æ—¶ï¼ŒæœåŠ¡å™¨å¿…é¡»è¿”å› <code>index.html</code>ï¼Œå¦åˆ™ä¼šå‡ºç° 404 é”™è¯¯ã€‚</li></ul><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createBrowserRouter, <span class="title class_">RouterProvider</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createBrowserRouter</span>([</span><br><span class="line">  <span class="comment">// ...è·¯ç”±é…ç½®</span></span><br><span class="line">]);</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">RouterProvider</span> <span class="attr">router</span>=<span class="string">&#123;router&#125;</span> /&gt;</span></span>;</span><br></pre></td></tr></table></figure><p><strong>æœåŠ¡å™¨é…ç½®ç¤ºä¾‹ (Nginx)ï¼š</strong></p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">location</span> / &#123;</span><br><span class="line">  <span class="attribute">try_files</span> <span class="variable">$uri</span> <span class="variable">$uri</span>/ /index.html;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2ï¼‰Hash-æ¨¡å¼"><a href="#2ï¼‰Hash-æ¨¡å¼" class="headerlink" title="2ï¼‰Hash æ¨¡å¼"></a><strong><font color="#10c300">2ï¼‰Hash æ¨¡å¼</font></strong></h4><p>ä½¿ç”¨ URL çš„ Hash éƒ¨åˆ† (<code>#</code>) æ¥æ¨¡æ‹Ÿä¸€ä¸ªå®Œæ•´çš„ URLã€‚</p><ul><li><strong>è¡¨ç°</strong>ï¼šURL å¸¦æœ‰ <code>#</code> å·ï¼Œä¾‹å¦‚ <code>example.com/#/user/123</code>ã€‚</li><li><strong>ä¼˜ç‚¹</strong>ï¼šå…¼å®¹æ€§æå¥½ï¼ˆæ”¯æŒè€æ—§æµè§ˆå™¨ï¼‰ï¼›<strong>ä¸éœ€è¦æœåŠ¡å™¨é¢å¤–é…ç½®</strong>ï¼ˆå› ä¸º <code>#</code> åé¢çš„å†…å®¹ä¸ä¼šå‘é€ç»™æœåŠ¡å™¨ï¼‰ã€‚</li><li><strong>ç¼ºç‚¹</strong>ï¼šURL ä¸å¤Ÿç¾è§‚ï¼›SEO è¾ƒå·®ï¼›æŸäº›ç¬¬ä¸‰æ–¹ç™»å½•å›è°ƒå¯èƒ½ä¸æ”¯æŒ Hash è·¯å¾„ã€‚</li></ul><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createHashRouter, <span class="title class_">RouterProvider</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createHashRouter</span>([</span><br><span class="line">  <span class="comment">// ...è·¯ç”±é…ç½®</span></span><br><span class="line">]);</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">RouterProvider</span> <span class="attr">router</span>=<span class="string">&#123;router&#125;</span> /&gt;</span></span>;</span><br></pre></td></tr></table></figure><h4 id="3ï¼‰å¦‚ä½•é€‰æ‹©ï¼Ÿ"><a href="#3ï¼‰å¦‚ä½•é€‰æ‹©ï¼Ÿ" class="headerlink" title="3ï¼‰å¦‚ä½•é€‰æ‹©ï¼Ÿ"></a><strong><font color="#10c300">3ï¼‰å¦‚ä½•é€‰æ‹©ï¼Ÿ</font></strong></h4><table><thead><tr><th align="left">ç‰¹æ€§</th><th align="left">History æ¨¡å¼ (<code>createBrowserRouter</code>)</th><th align="left">Hash æ¨¡å¼ (<code>createHashRouter</code>)</th></tr></thead><tbody><tr><td align="left"><strong>URL å¤–è§‚</strong></td><td align="left">ç¾è§‚ (<code>/path</code>)</td><td align="left">å¸¦äº•å· (<code>/#/path</code>)</td></tr><tr><td align="left"><strong>æœåŠ¡å™¨é…ç½®</strong></td><td align="left"><strong>éœ€è¦</strong> (Nginx&#x2F;Apache rewrite)</td><td align="left"><strong>ä¸éœ€è¦</strong></td></tr><tr><td align="left"><strong>SEO</strong></td><td align="left">å‹å¥½</td><td align="left">è¾ƒå·®</td></tr><tr><td align="left"><strong>éƒ¨ç½²éš¾åº¦</strong></td><td align="left">ä¸­</td><td align="left">ä½</td></tr><tr><td align="left"><strong>æ¨èåœºæ™¯</strong></td><td align="left">å…¬ç½‘é¡¹ç›®ã€ä¼ä¸šçº§åº”ç”¨</td><td align="left">å†…éƒ¨å·¥å…·ã€æ¼”ç¤º Demoã€æ— æ³•æ§åˆ¶æœåŠ¡å™¨é…ç½®æ—¶</td></tr></tbody></table><h4 id="4ï¼‰æ‹“å±•"><a href="#4ï¼‰æ‹“å±•" class="headerlink" title="4ï¼‰æ‹“å±•"></a><strong><font color="#10c300">4ï¼‰æ‹“å±•</font></strong></h4><p>1ï¸âƒ£History æ¨¡å¼ä¸‹ä¸ºä»€ä¹ˆéœ€è¦æœåŠ¡å™¨é…ç½®æ”¯æŒï¼Œä¸ºä»€ä¹ˆå½“ç”¨æˆ·ç›´æ¥è®¿é—®æ·±å±‚è·¯å¾„ï¼ˆå¦‚ <code>/user/123</code>ï¼‰æˆ–åˆ·æ–°é¡µé¢æ—¶ï¼ŒæœåŠ¡å™¨å¿…é¡»è¿”å› <code>index.html</code>ï¼Œå¦åˆ™ä¼šå‡ºç° 404 é”™è¯¯ã€‚</p><p>ç­”ï¼šå½“ä½ ç›´æ¥åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥ <a href="http://example.com/user/123">http://example.com/user/123</a> å¹¶å›è½¦ï¼ˆæˆ–æŒ‰åˆ·æ–°é”®ï¼‰ï¼š</p><ol><li>æµè§ˆå™¨ï¼šè¿™è¢«è§†ä¸ºä¸€æ¬¡å…¨æ–°çš„è®¿é—®ã€‚æµè§ˆå™¨ä¼šè€è€å®å®å‘æœåŠ¡å™¨å‘é€ä¸€ä¸ª HTTP GET è¯·æ±‚ï¼šâ€è¯·ç»™æˆ‘ &#x2F;user&#x2F;123 è¿™ä¸ªæ–‡ä»¶â€ã€‚</li><li><strong>æœåŠ¡å™¨</strong>ï¼šå»å®ƒçš„ç¡¬ç›˜æ–‡ä»¶ç³»ç»Ÿé‡Œæ‰¾<ul><li>å®ƒæ‰¾æœ‰æ²¡æœ‰ user æ–‡ä»¶å¤¹ï¼Ÿæ²¡æœ‰ã€‚</li><li>å®ƒæ‰¾æœ‰æ²¡æœ‰ user&#x2F;123 æ–‡ä»¶ï¼Ÿæ²¡æœ‰ã€‚</li><li>å®ƒæ‰¾æœ‰æ²¡æœ‰ user&#x2F;123.htmlï¼Ÿä¹Ÿæ²¡æœ‰ã€‚</li><li>å› ä¸º SPA é¡¹ç›®æ‰“åŒ…åï¼ŒæœåŠ¡å™¨ä¸Šé€šå¸¸åªæœ‰ä¸€ä¸ª index.html å’Œä¸€å † .js&#x2F;.css æ–‡ä»¶ï¼Œæ ¹æœ¬ä¸å­˜åœ¨ç‰©ç†ä¸Šçš„ &#x2F;user&#x2F;123 ç›®å½•ã€‚</li></ul></li><li><strong>ç»“æœ</strong>ï¼šæœåŠ¡å™¨è¯šå®åœ°è¿”å›äº† <strong>404 Not Found</strong>ã€‚</li></ol><br><h3 id="3-7-404-é¡µé¢é…ç½®"><a href="#3-7-404-é¡µé¢é…ç½®" class="headerlink" title="3.7 404 é¡µé¢é…ç½®"></a><strong><font color="red">3.7 404 é¡µé¢é…ç½®</font></strong></h3><p>åœ¨ SPA åº”ç”¨ä¸­ï¼Œå½“ç”¨æˆ·è®¿é—®äº†æœªå®šä¹‰çš„è·¯å¾„æ—¶ï¼Œå¦‚æœä¸åšå¤„ç†ï¼Œé¡µé¢å¯èƒ½ä¼šæ˜¾ç¤ºä¸€ç‰‡ç©ºç™½ã€‚æˆ‘ä»¬éœ€è¦é…ç½®ä¸€ä¸ª <strong>Catch-All è·¯ç”±</strong> æ¥å±•ç¤ºå‹å¥½çš„ 404 é¡µé¢ã€‚</p><p>åœ¨ React Router v6 ä¸­ï¼Œä½¿ç”¨ <code>path: &quot;*&quot;</code> å³å¯åŒ¹é…ä»»æ„è·¯å¾„ã€‚ç”±äº v6 å†…éƒ¨æœ‰æ™ºèƒ½çš„è·¯ç”±æ’åç®—æ³•ï¼ˆRanking Algorithmï¼‰ï¼Œä½ ä¸éœ€è¦åœ¨è¿™ä¸ªè·¯ç”±ä¸ŠåŠ  <code>exact</code>ï¼Œä¹Ÿä¸å¼ºæ±‚å°†å®ƒæ”¾åœ¨è·¯ç”±æ•°ç»„çš„æœ€åï¼ˆä½†åœ¨ v5 ä¸­å¿…é¡»æ”¾åœ¨æœ€åï¼‰ã€‚</p><h4 id="1ï¼‰åŸºç¡€é…ç½®"><a href="#1ï¼‰åŸºç¡€é…ç½®" class="headerlink" title="1ï¼‰åŸºç¡€é…ç½®"></a><strong><font color="#10c300">1ï¼‰åŸºç¡€é…ç½®</font></strong></h4><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/router/index.jsx</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createBrowserRouter</span>([</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/&quot;</span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Home</span> /&gt;</span></span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/about&quot;</span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">About</span> /&gt;</span></span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// ğŸ”¥ 404 è·¯ç”±é…ç½®ï¼ˆé€šå¸¸å»ºè®®æ”¾åœ¨æœ€åï¼Œä¾¿äºé˜…è¯»ï¼‰</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;*&quot;</span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">NotFound</span> /&gt;</span></span>,</span><br><span class="line">  &#125;,</span><br><span class="line">]);</span><br></pre></td></tr></table></figure><h4 id="2ï¼‰åˆ›å»ºä¼˜é›…çš„-404-ç»„ä»¶"><a href="#2ï¼‰åˆ›å»ºä¼˜é›…çš„-404-ç»„ä»¶" class="headerlink" title="2ï¼‰åˆ›å»ºä¼˜é›…çš„ 404 ç»„ä»¶"></a><strong><font color="#10c300">2ï¼‰åˆ›å»ºä¼˜é›…çš„ 404 ç»„ä»¶</font></strong></h4><p>ç®€å•çš„ 404 é¡µé¢åº”è¯¥åŒ…å«é”™è¯¯æç¤ºå’Œè¿”å›é¦–é¡µçš„æŒ‰é’®ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/pages/NotFound.jsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Link</span>, useNavigate &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">NotFound</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> navigate = <span class="title function_">useNavigate</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">textAlign:</span> &quot;<span class="attr">center</span>&quot;, <span class="attr">padding:</span> &quot;<span class="attr">50px</span>&quot; &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">fontSize:</span> &quot;<span class="attr">72px</span>&quot; &#125;&#125;&gt;</span>404<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">fontSize:</span> &quot;<span class="attr">24px</span>&quot; &#125;&#125;&gt;</span>æŠ±æ­‰ï¼Œæ‚¨è®¿é—®çš„é¡µé¢ä¸å­˜åœ¨ã€‚<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">marginTop:</span> &quot;<span class="attr">20px</span>&quot; &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> navigate(-1)&#125; style=&#123;&#123; marginRight: &quot;10px&quot; &#125;&#125;&gt;</span></span><br><span class="line"><span class="language-xml">          è¿”å›ä¸Šä¸€é¡µ</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;/&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">button</span>&gt;</span>å›åˆ°é¦–é¡µ<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3ï¼‰é‡å®šå‘åˆ°é¦–é¡µ"><a href="#3ï¼‰é‡å®šå‘åˆ°é¦–é¡µ" class="headerlink" title="3ï¼‰é‡å®šå‘åˆ°é¦–é¡µ"></a><strong><font color="#10c300">3ï¼‰é‡å®šå‘åˆ°é¦–é¡µ</font></strong></h4><p>æœ‰æ—¶å€™æˆ‘ä»¬ä¸å¸Œæœ›æ˜¾ç¤º 404 é¡µé¢ï¼Œè€Œæ˜¯ç›´æ¥å°†ç”¨æˆ·é‡å®šå‘å›é¦–é¡µï¼ˆä¾‹å¦‚åœ¨åå°ç®¡ç†ç³»ç»Ÿä¸­ï¼‰ã€‚å¯ä»¥ä½¿ç”¨ <code>&lt;Navigate&gt;</code> ç»„ä»¶ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">path</span>: <span class="string">&quot;*&quot;</span>,</span><br><span class="line">  <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Navigate</span> <span class="attr">to</span>=<span class="string">&quot;/&quot;</span> <span class="attr">replace</span> /&gt;</span></span>, <span class="comment">// replace: true é˜²æ­¢ç”¨æˆ·ç‚¹å‡»åé€€æ—¶é™·å…¥æ­»å¾ªç¯</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><hr><br><h2 id="å››ã€Data-API-è¿›é˜¶"><a href="#å››ã€Data-API-è¿›é˜¶" class="headerlink" title="å››ã€Data API (è¿›é˜¶)"></a><strong>å››ã€Data API (è¿›é˜¶)</strong></h2><p>React Router 6.4+ å¼•å…¥çš„ Data API ä¸ä»…ä»…æ˜¯å…³äºè·¯ç”±è·³è½¬ï¼Œå®ƒæä¾›äº†ä¸€å¥—å®Œæ•´çš„<strong>æ•°æ®ç”Ÿå‘½å‘¨æœŸç®¡ç†</strong>æ–¹æ¡ˆã€‚è¿™ä½¿å¾—æˆ‘ä»¬å¯ä»¥åœ¨è·¯ç”±å±‚é¢å¤„ç†æ•°æ®è·å–ã€æäº¤å’Œé”™è¯¯å¤„ç†ï¼Œå¤§å¤§å‡å°‘ç»„ä»¶å†…éƒ¨çš„å‰¯ä½œç”¨ä»£ç ã€‚</p><h3 id="4-1-æ•°æ®åŠ è½½-Loader"><a href="#4-1-æ•°æ®åŠ è½½-Loader" class="headerlink" title="4.1 æ•°æ®åŠ è½½ (Loader)"></a><strong><font color="red">4.1 æ•°æ®åŠ è½½ (Loader)</font></strong></h3><blockquote><p><strong>æ³¨æ„</strong>ï¼šLoader çš„åŸºç¡€ç”¨æ³•å·²åœ¨ <a href="#31-%E6%95%B0%E6%8D%AE%E5%8A%A0%E8%BD%BD-loader">3.1 èŠ‚</a> ä¸­ä»‹ç»ã€‚</p></blockquote><p>Loader æ˜¯ Data API çš„è¯»å–ç«¯ã€‚å®ƒåœ¨è·¯ç”±æ¸²æŸ“å‰è¿è¡Œï¼Œä¸ºç»„ä»¶æä¾›æ•°æ®ã€‚</p><p><strong>æ ¸å¿ƒä¼˜åŠ¿</strong>ï¼š</p><ol><li><strong>å¹¶è¡ŒåŠ è½½</strong>ï¼šè·¯ç”±ç»„ä»¶å’Œæ•°æ®å¹¶è¡Œè¯·æ±‚ï¼Œæ¶ˆé™¤ç€‘å¸ƒæµã€‚</li><li><strong>æ•°æ®&#x2F;UI åˆ†ç¦»</strong>ï¼šç»„ä»¶åªè´Ÿè´£æ¥æ”¶æ•°æ®æ¸²æŸ“ï¼Œä¸è´Ÿè´£ Fetchã€‚</li></ol><br><h3 id="4-2-æ•°æ®æäº¤-Action"><a href="#4-2-æ•°æ®æäº¤-Action" class="headerlink" title="4.2 æ•°æ®æäº¤ (Action)"></a><strong><font color="red">4.2 æ•°æ®æäº¤ (Action)</font></strong></h3><p>Action æ˜¯ Data API çš„å†™å…¥ç«¯ï¼Œç”¨äºå¤„ç†é GET è¯·æ±‚ï¼ˆå¦‚ POST, PUT, DELETEï¼‰ã€‚å®ƒä¸ <code>&lt;Form&gt;</code> ç»„ä»¶é…åˆï¼Œèƒ½åœ¨ä¸æ‰‹åŠ¨ç¼–å†™ <code>onSubmit</code> å’Œ <code>fetch</code> çš„æƒ…å†µä¸‹å®Œæˆæ•°æ®æäº¤ã€‚</p><h4 id="1ï¼‰å®šä¹‰-Action"><a href="#1ï¼‰å®šä¹‰-Action" class="headerlink" title="1ï¼‰å®šä¹‰ Action"></a><strong><font color="#10c300">1ï¼‰å®šä¹‰ Action</font></strong></h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/pages/Login.jsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; redirect &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">loginAction</span>(<span class="params">&#123; request &#125;</span>) &#123;</span><br><span class="line">  <span class="comment">// è·å–è¡¨å•æ•°æ®</span></span><br><span class="line">  <span class="keyword">const</span> formData = <span class="keyword">await</span> request.<span class="title function_">formData</span>();</span><br><span class="line">  <span class="keyword">const</span> data = <span class="title class_">Object</span>.<span class="title function_">fromEntries</span>(formData);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å‘èµ·è¯·æ±‚</span></span><br><span class="line">  <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&quot;/api/login&quot;</span>, &#123; <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>, <span class="attr">body</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(data) &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æˆåŠŸåé‡å®šå‘</span></span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">redirect</span>(<span class="string">&quot;/dashboard&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2ï¼‰ç»‘å®š-Config"><a href="#2ï¼‰ç»‘å®š-Config" class="headerlink" title="2ï¼‰ç»‘å®š Config"></a><strong><font color="#10c300">2ï¼‰ç»‘å®š Config</font></strong></h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// router/index.jsx</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">path</span>: <span class="string">&quot;/login&quot;</span>,</span><br><span class="line">  <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Login</span> /&gt;</span></span>,</span><br><span class="line">  <span class="attr">action</span>: loginAction, <span class="comment">// ğŸ‘ˆ ç»‘å®š action</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3ï¼‰ä½¿ç”¨-Form-ç»„ä»¶"><a href="#3ï¼‰ä½¿ç”¨-Form-ç»„ä»¶" class="headerlink" title="3ï¼‰ä½¿ç”¨ Form ç»„ä»¶"></a><strong><font color="#10c300">3ï¼‰ä½¿ç”¨ Form ç»„ä»¶</font></strong></h4><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Form</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Login</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Form</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>ç™»å½•<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Form</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><h3 id="4-3-æ— å¯¼èˆªäº¤äº’-useFetcher"><a href="#4-3-æ— å¯¼èˆªäº¤äº’-useFetcher" class="headerlink" title="4.3 æ— å¯¼èˆªäº¤äº’ (useFetcher)"></a><strong><font color="red">4.3 æ— å¯¼èˆªäº¤äº’ (useFetcher)</font></strong></h3><p>é€šå¸¸ç‚¹å‡»é“¾æ¥æˆ–æäº¤è¡¨å•ä¼šå¯¼è‡´é¡µé¢è·³è½¬ã€‚ä½†æœ‰äº›æ“ä½œæˆ‘ä»¬<strong>ä¸å¸Œæœ›è·³è½¬é¡µé¢</strong>ï¼Œæ¯”å¦‚ï¼š<strong>ç‚¹èµ</strong>ã€<strong>åŠ å…¥è´­ç‰©è½¦</strong>ã€<strong>Newsletter è®¢é˜…</strong>ã€‚è¿™æ—¶ä½¿ç”¨ <code>useFetcher</code>ã€‚</p><p>æä¾›äº† <code>fetcher.Form</code>ã€<code>fetcher.submit</code>ã€<code>fetcher.load</code> ç­‰æ–¹æ³•ï¼Œå¯ä»¥åœ¨ä¸å¯¼èˆªçš„æƒ…å†µä¸‹è§¦å‘ loader æˆ– actionã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useFetcher &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ProductItem</span>(<span class="params">&#123; product &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> fetcher = <span class="title function_">useFetcher</span>();</span><br><span class="line">  <span class="keyword">const</span> isSubmitting = fetcher.<span class="property">state</span> === <span class="string">&quot;submitting&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;product-card&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h3</span>&gt;</span>&#123;product.name&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;/* è¿™é‡Œçš„æäº¤ä¸ä¼šå¯¼è‡´é¡µé¢è·³è½¬ï¼Œä½†ä¼šè§¦å‘ action å¹¶è‡ªåŠ¨é‡æ–°éªŒè¯é¡µé¢æ•°æ® */&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">fetcher.Form</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">action</span>=<span class="string">&quot;/add-to-cart&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;productId&quot;</span> <span class="attr">value</span>=<span class="string">&#123;product.id&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">disabled</span>=<span class="string">&#123;isSubmitting&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;isSubmitting ? &quot;æ·»åŠ ä¸­...&quot; : &quot;åŠ å…¥è´­ç‰©è½¦&quot;&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">fetcher.Form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><h3 id="4-4-é”™è¯¯è¾¹ç•Œ-ErrorElement"><a href="#4-4-é”™è¯¯è¾¹ç•Œ-ErrorElement" class="headerlink" title="4.4 é”™è¯¯è¾¹ç•Œ (ErrorElement)"></a><strong><font color="red">4.4 é”™è¯¯è¾¹ç•Œ (ErrorElement)</font></strong></h3><p>æ¯ä¸ªè·¯ç”±éƒ½å¯ä»¥å®šä¹‰ä¸€ä¸ª <code>errorElement</code>ã€‚å½“ <code>loader</code>ã€<code>action</code> æˆ–ç»„ä»¶æ¸²æŸ“è¿‡ç¨‹ä¸­æŠ›å‡ºé”™è¯¯æ—¶ï¼ŒReact Router ä¼šæ•è·å®ƒå¹¶æ¸²æŸ“ <code>errorElement</code>ï¼Œè€Œä¸æ˜¯è®©æ•´ä¸ªé¡µé¢ç™½å±ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">path</span>: <span class="string">&quot;/&quot;</span>,</span><br><span class="line">  <span class="attr">loader</span>: <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;Oh no!&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Home</span> /&gt;</span></span>,</span><br><span class="line">  <span class="attr">errorElement</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ErrorPage</span> /&gt;</span></span>, <span class="comment">// ğŸ‘ˆ ç”¨æˆ·å°†çœ‹åˆ°è¿™ä¸ªç»„ä»¶</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><br><h2 id="äº”ã€å°è£…å¼è·¯ç”±é…ç½®-Best-Practice"><a href="#äº”ã€å°è£…å¼è·¯ç”±é…ç½®-Best-Practice" class="headerlink" title="äº”ã€å°è£…å¼è·¯ç”±é…ç½® (Best Practice)"></a><strong>äº”ã€å°è£…å¼è·¯ç”±é…ç½® (Best Practice)</strong></h2><p>åœ¨çœŸå®é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å°†è·¯ç”±é…ç½®æŠ½ç¦»åˆ°ç‹¬ç«‹æ–‡ä»¶ä¸­ç®¡ç†ï¼Œä½¿å…¶ç»“æ„æ›´æ¸…æ™°ã€‚</p><h3 id="5-1-ç›®å½•ç»“æ„"><a href="#5-1-ç›®å½•ç»“æ„" class="headerlink" title="5.1 ç›®å½•ç»“æ„"></a><strong><font color="red">5.1 ç›®å½•ç»“æ„</font></strong></h3><p>æ¨èåœ¨ <code>src/router</code> ç›®å½•ä¸‹ç®¡ç†è·¯ç”±ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">src/</span><br><span class="line">â”œâ”€â”€ main.jsx         &lt;-- å…¥å£æ–‡ä»¶</span><br><span class="line">â”œâ”€â”€ pages/</span><br><span class="line">â”‚   â”œâ”€â”€ Home.jsx</span><br><span class="line">â”‚   â”œâ”€â”€ Login.jsx</span><br><span class="line">â”‚   â””â”€â”€ Dashboard.jsx</span><br><span class="line">â”œâ”€â”€ router/</span><br><span class="line">â”‚   â””â”€â”€ index.jsx    &lt;-- è·¯ç”±é…ç½®æ–‡ä»¶</span><br></pre></td></tr></table></figure><br><h3 id="5-2-è·¯ç”±é…ç½®æ–‡ä»¶"><a href="#5-2-è·¯ç”±é…ç½®æ–‡ä»¶" class="headerlink" title="5.2 è·¯ç”±é…ç½®æ–‡ä»¶"></a><strong><font color="red">5.2 è·¯ç”±é…ç½®æ–‡ä»¶</font></strong></h3><p>åˆ©ç”¨ <code>createBrowserRouter</code> å’Œ <code>lazy</code> å®ç°é…ç½®åŒ–ä¸æ‡’åŠ è½½çš„å®Œç¾ç»“åˆã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/router/index.jsx</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; lazy &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; createBrowserRouter, <span class="title class_">Navigate</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‡’åŠ è½½é¡µé¢ç»„ä»¶</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Home</span> = <span class="title function_">lazy</span>(<span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;../pages/Home&quot;</span>));</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">About</span> = <span class="title function_">lazy</span>(<span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;../pages/About&quot;</span>));</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Dashboard</span> = <span class="title function_">lazy</span>(<span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;../pages/Dashboard&quot;</span>));</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Login</span> = <span class="title function_">lazy</span>(<span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;../pages/Login&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŠ è½½ä¸­ç»„ä»¶</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Loading</span> = (<span class="params"></span>) =&gt; <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;p-4&quot;</span>&gt;</span>Loading...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·¯ç”±è¡¨å®šä¹‰</span></span><br><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/&quot;</span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="title class_">Home</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/login&quot;</span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="title class_">Login</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/dashboard&quot;</span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="title class_">Dashboard</span>,</span><br><span class="line">    <span class="comment">// åµŒå¥—è·¯ç”±é…ç½®</span></span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&quot;stats&quot;</span>, <span class="comment">// è·¯å¾„ä¸º /dashboard/stats   å­è·¯ç”±ä¸è¦åŠ &#x27;/&#x27;</span></span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Stats View<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&quot;settings&quot;</span>, <span class="comment">// è·¯å¾„ä¸º /dashboard/settings</span></span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Settings View<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 404 è·¯ç”±å¤„ç†</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;*&quot;</span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Navigate</span> <span class="attr">to</span>=<span class="string">&quot;/&quot;</span> <span class="attr">replace</span> /&gt;</span></span>,</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºå¹¶å¯¼å‡ºè·¯ç”±å®ä¾‹</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createBrowserRouter</span>(routes);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router;</span><br></pre></td></tr></table></figure><br><h3 id="5-3-æ¥å…¥"><a href="#5-3-æ¥å…¥" class="headerlink" title="5.3 æ¥å…¥"></a><strong><font color="red">5.3 æ¥å…¥</font></strong></h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// App.jsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">RouterProvider</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Suspense</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&quot;./router&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Suspense</span> <span class="attr">fallback</span>=<span class="string">&#123;</span>&lt;<span class="attr">div</span>&gt;</span>Loading...<span class="tag">&lt;/<span class="name">div</span>&gt;</span>&#125;&gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">RouterProvider</span> <span class="attr">router</span>=<span class="string">&#123;router&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Suspense</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><hr><br><h2 id="å…­ã€è¿›é˜¶ä¸ä¼˜åŒ–"><a href="#å…­ã€è¿›é˜¶ä¸ä¼˜åŒ–" class="headerlink" title="å…­ã€è¿›é˜¶ä¸ä¼˜åŒ–"></a><strong>å…­ã€è¿›é˜¶ä¸ä¼˜åŒ–</strong></h2><p>åœ¨å°è£…å¼å†™æ³•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªåŒ…è£…ç»„ä»¶æ¥ä¿æŠ¤è·¯ç”±ã€‚</p><h3 id="6-1-è·¯ç”±å®ˆå«-Protected-Routes"><a href="#6-1-è·¯ç”±å®ˆå«-Protected-Routes" class="headerlink" title="6.1 è·¯ç”±å®ˆå« (Protected Routes)"></a><strong><font color="red">6.1 è·¯ç”±å®ˆå« (Protected Routes)</font></strong></h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// components/AuthGuard.jsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Navigate</span>, useLocation &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">AuthGuard</span>(<span class="params">&#123; children &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> isLogged = <span class="literal">false</span>; <span class="comment">// æ›¿æ¢ä¸ºçœŸå®çš„é‰´æƒé€»è¾‘</span></span><br><span class="line">  <span class="keyword">const</span> location = <span class="title function_">useLocation</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!isLogged) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">Navigate</span> <span class="attr">to</span>=<span class="string">&quot;/login&quot;</span> <span class="attr">state</span>=<span class="string">&#123;&#123;</span> <span class="attr">from:</span> <span class="attr">location</span> &#125;&#125; <span class="attr">replace</span> /&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> children;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// src/router/index.js ä½¿ç”¨</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">path</span>: <span class="string">&#x27;/admin&#x27;</span>,</span><br><span class="line">  <span class="attr">element</span>: (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">AuthGuard</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">AdminPage</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">AuthGuard</span>&gt;</span></span></span><br><span class="line">  ),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><h3 id="6-2-å…¨å±€-Loading-çŠ¶æ€"><a href="#6-2-å…¨å±€-Loading-çŠ¶æ€" class="headerlink" title="6.2 å…¨å±€ Loading çŠ¶æ€"></a><strong><font color="red">6.2 å…¨å±€ Loading çŠ¶æ€</font></strong></h3><p>ä½¿ç”¨ <code>useNavigation</code> ç›‘å¬å…¨å±€è·¯ç”±è·³è½¬çŠ¶æ€ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useNavigation, <span class="title class_">Outlet</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">RootLayout</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> navigation = <span class="title function_">useNavigation</span>();</span><br><span class="line">  <span class="keyword">const</span> isLoading = navigation.<span class="property">state</span> === <span class="string">&quot;loading&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;isLoading &amp;&amp; <span class="tag">&lt;<span class="name">GlobalSpinner</span> /&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Outlet</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><br><h2 id="ä¸ƒã€å¸¸è§è¯¯åŒº-Common-Pitfalls"><a href="#ä¸ƒã€å¸¸è§è¯¯åŒº-Common-Pitfalls" class="headerlink" title="ä¸ƒã€å¸¸è§è¯¯åŒº (Common Pitfalls)"></a><strong>ä¸ƒã€å¸¸è§è¯¯åŒº (Common Pitfalls)</strong></h2><h3 id="7-1-é”™è¯¯ä½¿ç”¨-Layout-ç»„ä»¶-Context-ä¸¢å¤±"><a href="#7-1-é”™è¯¯ä½¿ç”¨-Layout-ç»„ä»¶-Context-ä¸¢å¤±" class="headerlink" title="7.1 é”™è¯¯ä½¿ç”¨ Layout ç»„ä»¶ (Context ä¸¢å¤±)"></a><strong><font color="red">7.1 é”™è¯¯ä½¿ç”¨ Layout ç»„ä»¶ (Context ä¸¢å¤±)</font></strong></h3><p>å¾ˆå¤šåˆå­¦è€…å®¹æ˜“çŠ¯çš„ä¸€ä¸ªé”™è¯¯æ˜¯ï¼š<strong>å°†å¸ƒå±€ç»„ä»¶ (<code>Layout</code> &#x2F; <code>Menu</code>) é˜²æ­¢åœ¨ <code>RouterProvider</code> ä¹‹å¤–</strong>ã€‚</p><p><strong>é”™è¯¯å†™æ³•ï¼š</strong></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// App.jsx</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Layout</span> /&gt;</span> &#123;/* âŒ é”™è¯¯ï¼šLayout åœ¨ RouterContext ä¹‹å¤– */&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">RouterProvider</span> <span class="attr">router</span>=<span class="string">&#123;router&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>é—®é¢˜åæœï¼š</strong></p><ol><li><strong>æ— æ³•ä½¿ç”¨ <code>&lt;Link&gt;</code> &#x2F; <code>&lt;NavLink&gt;</code></strong>ï¼šç‚¹å‡»èœå•ä¼šæŠ¥é”™ <code>useHref() may be used only in the context of a &lt;Router&gt; component.</code></li><li><strong>æ— æ³•ä½¿ç”¨ hooks</strong>ï¼š<code>useLocation</code>ã€<code>useNavigate</code> ç­‰ Hook å‡æ— æ³•å·¥ä½œã€‚</li><li><strong>è·¯ç”±çŠ¶æ€æ— æ³•å…±äº«</strong>ï¼šå¸ƒå±€ç»„ä»¶æ— æ³•æ„ŸçŸ¥å½“å‰çš„è·¯ç”±å˜åŒ–ã€‚</li><li>å¦‚æœLayoutä¸­æ˜¯å›ºå®šçš„å†…å®¹ï¼Œä¸æ¶‰åŠè·¯ç”±è·³è½¬ç­‰ï¼Œå¸ƒå±€ç»„ä»¶åˆ™å¯ä»¥å†™åœ¨ <code>RouterProvider</code> ä¹‹å¤–</li></ol><p><strong>æœ€ä½³å®è·µ</strong>ï¼šæ˜¯åˆ©ç”¨ <strong>åµŒå¥—è·¯ç”± (Nested Routes)</strong> å’Œ <code>&lt;Outlet /&gt;</code>ã€‚</p><p><strong>ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºå¸ƒå±€ç»„ä»¶ (src&#x2F;components&#x2F;Layout.jsx)</strong></p><p>åˆ©ç”¨ <code>&lt;Outlet /&gt;</code> æ¸²æŸ“å­è·¯ç”±å†…å®¹ï¼š</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Outlet</span>, <span class="title class_">Link</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Layout</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;layout&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">nav</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;/&quot;</span>&gt;</span>é¦–é¡µ<span class="tag">&lt;/<span class="name">Link</span>&gt;</span> | <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;/about&quot;</span>&gt;</span>å…³äº<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;/* å­è·¯ç”±çš„å†…å®¹å°†æ¸²æŸ“åœ¨è¿™é‡Œ */&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Outlet</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Layout</span>;</span><br></pre></td></tr></table></figure><p><strong>ç¬¬äºŒæ­¥ï¼šé…ç½®åµŒå¥—è·¯ç”± (src&#x2F;router&#x2F;index.jsx)</strong></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createBrowserRouter &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Layout</span> <span class="keyword">from</span> <span class="string">&quot;../components/Layout&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&quot;../pages/Home&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">About</span> <span class="keyword">from</span> <span class="string">&quot;../pages/About&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createBrowserRouter</span>([</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/&quot;</span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Layout</span> /&gt;</span></span>, <span class="comment">// 1. æ ¹è·¯å¾„æ¸²æŸ“å¸ƒå±€</span></span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      <span class="comment">// 2. å­è·¯ç”±æ¸²æŸ“åœ¨ Layout çš„ Outlet ä¸­</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">index</span>: <span class="literal">true</span>, <span class="comment">// é»˜è®¤å­è·¯ç”± (å¯¹åº” path: &quot;/&quot;)</span></span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Home</span> /&gt;</span></span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&quot;about&quot;</span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">About</span> /&gt;</span></span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router;</span><br></pre></td></tr></table></figure><p><strong>ç¬¬ä¸‰æ­¥ï¼šå…¥å£æ–‡ä»¶ (src&#x2F;main.jsx)</strong></p><p>å…¥å£æ–‡ä»¶ä¿æŒç®€æ´ï¼Œåªéœ€æ³¨å…¥ <code>router</code>ï¼š</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&quot;react-dom/client&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">RouterProvider</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&quot;./router&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;root&quot;</span>)).<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">React.StrictMode</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">RouterProvider</span> <span class="attr">router</span>=<span class="string">&#123;router&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    &#123;/*  é»˜è®¤è¿™é‡Œæ˜¯APPç»„ä»¶ï¼Œä¹Ÿå¯ä»¥å°†<span class="tag">&lt;<span class="name">RouterProvider</span> <span class="attr">router</span>=<span class="string">&#123;router&#125;</span> /&gt;</span>å†™åˆ°APPç»„ä»¶ä¸­å» */&#125;</span></span><br><span class="line"><span class="language-xml">    &#123;/*  <span class="tag">&lt;<span class="name">App</span> /&gt;</span> */&#125;</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">React.StrictMode</span>&gt;</span></span>,</span><br><span class="line">);</span><br></pre></td></tr></table></figure><hr><br><h2 id="å…«ã€æ€»ç»“"><a href="#å…«ã€æ€»ç»“" class="headerlink" title="å…«ã€æ€»ç»“"></a><strong>å…«ã€æ€»ç»“</strong></h2><p>React Router v6.4+ å®šä¹‰äº†ç°ä»£ React åº”ç”¨çš„è·¯ç”±æ ‡å‡†ï¼š</p><ol><li><strong>ä½¿ç”¨ <code>createBrowserRouter</code></strong> è¿›è¡Œé›†ä¸­å¼è·¯ç”±ç®¡ç†ã€‚</li><li><strong>åˆ©ç”¨ <code>loader</code></strong> æå‰åŠ è½½æ•°æ®ï¼Œæå‡é¦–å±ä½“éªŒã€‚</li><li><strong>ç»“åˆ <code>Suspense</code> å’Œ <code>lazy</code></strong> å®ç°ä»£ç åˆ†å‰²ã€‚</li><li><strong>ç›®å½•ç»“æ„è§„èŒƒåŒ–</strong>ï¼Œå°†è·¯ç”±é€»è¾‘ä¸ UI ç»„ä»¶åˆ†ç¦»ã€‚</li></ol><p>æŒæ¡è¿™å¥—æ¨¡å¼ï¼Œä½ å°†èƒ½æ„å»ºå‡ºæ€§èƒ½æ›´ä¼˜ã€æ¶æ„æ›´æ¸…æ™°çš„ React åº”ç”¨ã€‚</p></div><div class="post-footer"><div>è½¬è½½å£°æ˜ï¼š å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒ,éå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ Â© <a href="" target="_blank">ZHB</a></div><div></div></div></article><div class="article-nav prev-next-wrap clearfix"><a href="/posts/rtk-guide-2026.html" class="pre-post btn btn-default" title="React Redux å…¨é¢æŒ‡å— (RTK)"><i class="fa fa-angle-left fa-fw"></i> <span class="hidden-lg">ä¸Šä¸€ç¯‡</span> <span class="hidden-xs">React Redux å…¨é¢æŒ‡å— (RTK)</span></a> <a href="/posts/4179c0b9.html" class="next-post btn btn-default" title="React å®Œå…¨æŒ‡å— (React 18 & 19)"><span class="hidden-lg">ä¸‹ä¸€ç¯‡</span> <span class="hidden-xs">React å®Œå…¨æŒ‡å— (React 18 & 19)</span><i class="fa fa-angle-right fa-fw"></i></a></div><div id="comments"><div class="utteranc"><script src="https://utteranc.es/client.js" repo="shenliyang/snippet-comment" issue-term="pathname" issue-number="" theme="github-light" label="" crossorigin="anonymous" async></script></div></div></main><aside id="article-toc" role="navigation" class="col-md-3"><div class="widget"><h3 class="title">æ–‡ç« ç›®å½•</h3><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#React-Router-%E5%85%A8%E9%9D%A2%E6%8C%87%E5%8D%97-v6-4-v7"><span class="toc-text">React Router å…¨é¢æŒ‡å— (v6.4+ &amp; v7)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95"><span class="toc-text">ç›®å½•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%BC%95%E8%A8%80"><span class="toc-text">ä¸€ã€å¼•è¨€</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E8%B7%AF%E7%94%B1%EF%BC%9F-SPA-vs-MPA"><span class="toc-text">1.1 ä¸ºä»€ä¹ˆéœ€è¦è·¯ç”±ï¼Ÿ (SPA vs MPA)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-React-Router-v6-4-Data-APIs"><span class="toc-text">1.2 React Router v6.4+ (Data APIs)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-React-Router-v7-%E4%B8%89%E7%A7%8D%E4%BD%BF%E7%94%A8%E6%A8%A1%E5%BC%8F"><span class="toc-text">1.3 React Router v7+ä¸‰ç§ä½¿ç”¨æ¨¡å¼</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%B8%89%E7%A7%8D%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-text">1. ä¸‰ç§æ¨¡å¼çš„åŒºåˆ«</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B-Data-Router"><span class="toc-text">äºŒã€å¿«é€Ÿä¸Šæ‰‹ (Data Router)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E5%AE%89%E8%A3%85"><span class="toc-text">2.1 å®‰è£…</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-text">2.2 åŸºæœ¬ä½¿ç”¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E8%B7%AF%E7%94%B1%E6%A0%B8%E5%BF%83%E5%9F%BA%E7%A1%80-Routing"><span class="toc-text">ä¸‰ã€è·¯ç”±æ ¸å¿ƒåŸºç¡€ (Routing)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E6%95%B0%E6%8D%AE%E5%8A%A0%E8%BD%BD-Loader"><span class="toc-text">3.1 æ•°æ®åŠ è½½ (Loader)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E8%B7%AF%E7%94%B1%E8%B7%B3%E8%BD%AC-Navigation"><span class="toc-text">3.2 è·¯ç”±è·³è½¬ (Navigation)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%EF%BC%89%E5%A3%B0%E6%98%8E%E5%BC%8F%E8%B7%B3%E8%BD%AC"><span class="toc-text">1ï¼‰å£°æ˜å¼è·³è½¬</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%EF%BC%89%E7%BC%96%E7%A8%8B%E5%BC%8F%E8%B7%B3%E8%BD%AC"><span class="toc-text">2ï¼‰ç¼–ç¨‹å¼è·³è½¬</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92-Params"><span class="toc-text">3.3 å‚æ•°ä¼ é€’ (Params)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%EF%BC%89%E8%B7%AF%E5%BE%84%E5%8F%82%E6%95%B0-Path-Params"><span class="toc-text">1ï¼‰è·¯å¾„å‚æ•° (Path Params)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%EF%BC%89%E6%9F%A5%E8%AF%A2%E5%8F%82%E6%95%B0-Query-Params"><span class="toc-text">2ï¼‰æŸ¥è¯¢å‚æ•° (Query Params)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%EF%BC%89%E9%9A%90%E5%BC%8F%E7%8A%B6%E6%80%81-State"><span class="toc-text">3ï¼‰éšå¼çŠ¶æ€ (State)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-%E5%B5%8C%E5%A5%97%E8%B7%AF%E7%94%B1%E4%B8%8E-Outlet"><span class="toc-text">3.4 åµŒå¥—è·¯ç”±ä¸ Outlet</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%EF%BC%89%E4%BB%80%E4%B9%88%E6%98%AF%E5%B5%8C%E5%A5%97%E8%B7%AF%E7%94%B1%EF%BC%9F"><span class="toc-text">1ï¼‰ä»€ä¹ˆæ˜¯åµŒå¥—è·¯ç”±ï¼Ÿ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%EF%BC%89%E5%B5%8C%E5%A5%97%E9%85%8D%E7%BD%AE"><span class="toc-text">2ï¼‰åµŒå¥—é…ç½®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%EF%BC%89%E7%88%B6%E7%BB%84%E4%BB%B6%E5%A6%82%E4%BD%95%E6%B8%B2%E6%9F%93%E5%AD%90%E8%B7%AF%E7%94%B1%EF%BC%9F"><span class="toc-text">3ï¼‰çˆ¶ç»„ä»¶å¦‚ä½•æ¸²æŸ“å­è·¯ç”±ï¼Ÿ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%EF%BC%89%E6%80%BB%E7%BB%93%EF%BC%9A%E8%B7%AF%E7%94%B1%E5%8C%B9%E9%85%8D%E6%B5%81%E7%A8%8B"><span class="toc-text">4ï¼‰æ€»ç»“ï¼šè·¯ç”±åŒ¹é…æµç¨‹</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-%E8%B7%AF%E7%94%B1%E6%87%92%E5%8A%A0%E8%BD%BD"><span class="toc-text">3.5 è·¯ç”±æ‡’åŠ è½½</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%EF%BC%89%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E6%87%92%E5%8A%A0%E8%BD%BD%EF%BC%9F"><span class="toc-text">1ï¼‰ä¸ºä»€ä¹ˆè¦æ‡’åŠ è½½ï¼Ÿ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%EF%BC%89%E6%A0%B8%E5%BF%83-API%EF%BC%9AReact-lazy-Suspense"><span class="toc-text">2ï¼‰æ ¸å¿ƒ APIï¼šReact.lazy &amp; Suspense</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6-%E8%B7%AF%E7%94%B1%E6%A8%A1%E5%BC%8F"><span class="toc-text">3.6 è·¯ç”±æ¨¡å¼</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%EF%BC%89History-%E6%A8%A1%E5%BC%8F-%E6%8E%A8%E8%8D%90"><span class="toc-text">1ï¼‰History æ¨¡å¼ (æ¨è)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%EF%BC%89Hash-%E6%A8%A1%E5%BC%8F"><span class="toc-text">2ï¼‰Hash æ¨¡å¼</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%EF%BC%89%E5%A6%82%E4%BD%95%E9%80%89%E6%8B%A9%EF%BC%9F"><span class="toc-text">3ï¼‰å¦‚ä½•é€‰æ‹©ï¼Ÿ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%EF%BC%89%E6%8B%93%E5%B1%95"><span class="toc-text">4ï¼‰æ‹“å±•</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-7-404-%E9%A1%B5%E9%9D%A2%E9%85%8D%E7%BD%AE"><span class="toc-text">3.7 404 é¡µé¢é…ç½®</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%EF%BC%89%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE"><span class="toc-text">1ï¼‰åŸºç¡€é…ç½®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%EF%BC%89%E5%88%9B%E5%BB%BA%E4%BC%98%E9%9B%85%E7%9A%84-404-%E7%BB%84%E4%BB%B6"><span class="toc-text">2ï¼‰åˆ›å»ºä¼˜é›…çš„ 404 ç»„ä»¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%EF%BC%89%E9%87%8D%E5%AE%9A%E5%90%91%E5%88%B0%E9%A6%96%E9%A1%B5"><span class="toc-text">3ï¼‰é‡å®šå‘åˆ°é¦–é¡µ</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81Data-API-%E8%BF%9B%E9%98%B6"><span class="toc-text">å››ã€Data API (è¿›é˜¶)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E6%95%B0%E6%8D%AE%E5%8A%A0%E8%BD%BD-Loader"><span class="toc-text">4.1 æ•°æ®åŠ è½½ (Loader)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E6%95%B0%E6%8D%AE%E6%8F%90%E4%BA%A4-Action"><span class="toc-text">4.2 æ•°æ®æäº¤ (Action)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%EF%BC%89%E5%AE%9A%E4%B9%89-Action"><span class="toc-text">1ï¼‰å®šä¹‰ Action</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%EF%BC%89%E7%BB%91%E5%AE%9A-Config"><span class="toc-text">2ï¼‰ç»‘å®š Config</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%EF%BC%89%E4%BD%BF%E7%94%A8-Form-%E7%BB%84%E4%BB%B6"><span class="toc-text">3ï¼‰ä½¿ç”¨ Form ç»„ä»¶</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-%E6%97%A0%E5%AF%BC%E8%88%AA%E4%BA%A4%E4%BA%92-useFetcher"><span class="toc-text">4.3 æ— å¯¼èˆªäº¤äº’ (useFetcher)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-%E9%94%99%E8%AF%AF%E8%BE%B9%E7%95%8C-ErrorElement"><span class="toc-text">4.4 é”™è¯¯è¾¹ç•Œ (ErrorElement)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E5%B0%81%E8%A3%85%E5%BC%8F%E8%B7%AF%E7%94%B1%E9%85%8D%E7%BD%AE-Best-Practice"><span class="toc-text">äº”ã€å°è£…å¼è·¯ç”±é…ç½® (Best Practice)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84"><span class="toc-text">5.1 ç›®å½•ç»“æ„</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E8%B7%AF%E7%94%B1%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-text">5.2 è·¯ç”±é…ç½®æ–‡ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E6%8E%A5%E5%85%A5"><span class="toc-text">5.3 æ¥å…¥</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E8%BF%9B%E9%98%B6%E4%B8%8E%E4%BC%98%E5%8C%96"><span class="toc-text">å…­ã€è¿›é˜¶ä¸ä¼˜åŒ–</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E8%B7%AF%E7%94%B1%E5%AE%88%E5%8D%AB-Protected-Routes"><span class="toc-text">6.1 è·¯ç”±å®ˆå« (Protected Routes)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-%E5%85%A8%E5%B1%80-Loading-%E7%8A%B6%E6%80%81"><span class="toc-text">6.2 å…¨å±€ Loading çŠ¶æ€</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E5%B8%B8%E8%A7%81%E8%AF%AF%E5%8C%BA-Common-Pitfalls"><span class="toc-text">ä¸ƒã€å¸¸è§è¯¯åŒº (Common Pitfalls)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-%E9%94%99%E8%AF%AF%E4%BD%BF%E7%94%A8-Layout-%E7%BB%84%E4%BB%B6-Context-%E4%B8%A2%E5%A4%B1"><span class="toc-text">7.1 é”™è¯¯ä½¿ç”¨ Layout ç»„ä»¶ (Context ä¸¢å¤±)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB%E3%80%81%E6%80%BB%E7%BB%93"><span class="toc-text">å…«ã€æ€»ç»“</span></a></li></ol></li></ol></div></aside></div></div></section><footer class="main-footer"><div class="container"><div class="row"></div></div></footer><a id="back-to-top" class="icon-btn hide"><i class="fa fa-chevron-up"></i></a><div class="copyright"><div class="container"><div class="row"><div class="col-sm-12"><div class="busuanzi"></div></div><div class="col-sm-12"><span>Copyright &copy; 2017</span> | <span>Powered by <a href="//hexo.io" class="copyright-links" target="_blank" rel="nofollow">Hexo</a></span> | <span>Theme by <a href="//github.com/shenliyang/hexo-theme-snippet.git" class="copyright-links" target="_blank" rel="nofollow">Snippet</a></span></div></div></div></div><script src="/js/app.js?rev=2f9097f8c1d5adfecd923b78b47be31b"></script></body></html>